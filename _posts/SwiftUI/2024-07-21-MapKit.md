---
title: MapKit
writer: Harold
date: 2024-7-21 07:33:00 +0800
categories: [Udemy, SwiftUI]
tags: [SwiftUI]

toc: true
toc_sticky: true
---

MapView íŒŒì¼ì„ í•˜ë‚˜ ë§Œë“¤ì–´ì¤€ë‹¤.

ê·¸ë¦¬ê³  MapKitì„ import í•´ì£¼ì.

ì§€ë„ë¥¼ í™”ë©´ì— ë³´ì—¬ì£¼ëŠ”ê±´ ì•„ì£¼ ê°„ë‹¨í•˜ë‹¤

ê·¸ëƒ¥ `Map()`ì„ ì ìœ¼ë©´ ëœë‹¤.

```swift
struct MapView: View {
    var body: some View {
        Map()
    }
}
```

![CleanShot 2024-09-10 at 00 09 09@2x](https://github.com/user-attachments/assets/9cb6ec66-34fd-45af-8f88-fb6233f0a147){: width="50%" height="50%"}

ì´ë ‡ê²Œ ë°”ë¡œ ì§€ë„ê°€ ë³´ì´ê²Œ ëœë‹¤.

### 1. ì„¤ì •í•œ ì§€ì—­ì„ ë³´ì´ê²Œ êµ¬í˜„í•˜ê¸°

ìš°ë¦¬ê°€ ì´ì „ì— Placeë¥¼ í†µí•´ ì—¬ëŸ¬ ìƒ˜í”Œì˜ ì¢Œí‘œë¥¼ ì§€ì •í•´ë‘ì—ˆë‹¤.

ê·¸ê²ƒì„ í™œìš©í•´ì„œ ì§€ë„ì— ë³´ì—¬ì§€ê²Œ í•´ë³´ì.

ìš°ì„  previewì— ë‹¤ìŒê³¼ ê°™ì´ ì ì–´ë³´ì

```swift
#Preview {
    MapView(place: Place.previewPlaces[0], position: .camera(MapCamera(
        centerCoordinate: Place.previewPlaces[0].location,
        distance: 1000,
        heading: 250,
        pitch: 80
    )))
}
```

headingê³¼ pitchëŠ” ì§€ë„ë‚˜ ì¹´ë©”ë¼ ë·°ì—ì„œ ì¹´ë©”ë¼ì˜ ë°©í–¥ê³¼ ê°ë„ë¥¼ ì¡°ì ˆí•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì¤‘ìš”í•œ ì†ì„±ë“¤ì´ë‹¤. íŠ¹íˆ ì§€ë„ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©ìê°€ ì§€ë„ë¥¼ ë³´ëŠ” ê°ë„ì™€ ë°©í–¥ì„ ì œì–´í•  ë•Œ ìœ ìš©í•˜ë‹¤.

1. Heading (í—¤ë”©)
- ì„¤ëª…: í—¤ë”©ì€ ì¹´ë©”ë¼ê°€ ë°”ë¼ë³´ëŠ” ë°©í–¥ì„ ë‚˜íƒ€ë‚´ëŠ” ê°’ì´ë‹¤. ì§€ë„ë¥¼ ìœ„ì—ì„œ ë‚´ë ¤ë‹¤ë³¼ ë•Œ, ê¸°ë³¸ ë°©í–¥ì€ ë¶ìª½(0ë„)ì´ë‹¤. í—¤ë”© ê°’ì€ ì‹œê³„ ë°©í–¥ìœ¼ë¡œ ì¦ê°€í•˜ë©°, 360ë„ëŠ” ë‹¤ì‹œ ë¶ìª½ì„ ê°€ë¦¬í‚¨ë‹¤.
- ë²”ìœ„: 0ì—ì„œ 360ê¹Œì§€ì˜ ê°’ìœ¼ë¡œ, 0ë„ëŠ” ë¶ìª½, 90ë„ëŠ” ë™ìª½, 180ë„ëŠ” ë‚¨ìª½, 270ë„ëŠ” ì„œìª½ì„ ê°€ë¦¬í‚¨ë‹¤.
- ì˜ˆì‹œ:
	- 0ë„: ë¶ìª½ì„ ë°”ë¼ë´„
	- 90ë„: ë™ìª½ì„ ë°”ë¼ë´„
	- 180ë„: ë‚¨ìª½ì„ ë°”ë¼ë´„
	- 270ë„: ì„œìª½ì„ ë°”ë¼ë´„

2. Pitch (í”¼ì¹˜)
- ì„¤ëª…: í”¼ì¹˜ëŠ” ì¹´ë©”ë¼ì˜ ê¸°ìš¸ê¸°ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’ì´ë‹¤. í”¼ì¹˜ëŠ” ì§€ë„ ë˜ëŠ” 3D ë·°ë¥¼ ìˆ˜ì§ ë°©í–¥ì—ì„œ ì–¼ë§ˆë‚˜ ê¸°ìš¸ì—¬ì„œ ë³¼ì§€ë¥¼ ê²°ì •í•œë‹¤.
- ë²”ìœ„: 0ì—ì„œ 90ê¹Œì§€ì˜ ê°’ìœ¼ë¡œ, 0ë„ëŠ” ìˆ˜ì§ìœ¼ë¡œ ì•„ë˜ë¥¼ ë‚´ë ¤ë‹¤ë³´ëŠ” ê²ƒì´ê³ , 90ë„ëŠ” ì§€ë©´ê³¼ ìˆ˜í‰í•˜ê²Œ ë³´ëŠ” ê²ƒì´ë‹¤.
- ì˜ˆì‹œ:
	- 0ë„: ì§€ë„ë¥¼ ìˆ˜ì§ìœ¼ë¡œ ë‚´ë ¤ë‹¤ë³´ëŠ” ë·° (íƒ‘ë‹¤ìš´ ë·°)
	- 45ë„: ì§€ë„ë¥¼ ì•½ê°„ ê¸°ìš¸ì—¬ì„œ ë³´ëŠ” ë·° (ì¼ë¶€ ì§€í˜•ì´ ë³´ì´ê¸° ì‹œì‘í•¨)
	- 80ë„: ê±°ì˜ ìˆ˜í‰ìœ¼ë¡œ ì§€í˜•ê³¼ ê±´ë¬¼ ë“±ì„ ë³¼ ìˆ˜ ìˆëŠ” ë·° (ì§€ìƒì—ì„œ ë³´ëŠ” ê²ƒê³¼ ìœ ì‚¬í•œ ë·°)

í•˜ì§€ë§Œ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤?

ì™œëƒí•˜ë©´ body ë¶€ë¶„ì„ ë” ë³´ì™„í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

ê·¸ì „ì—, í˜„ì¬ í”„ë¦¬ë·°ìª½ ì½”ë“œì—ì„œ `Place.previewPlaces[0]` ì´ê²Œ ë‘ë²ˆ ë°˜ë³µì´ ëœë‹¤.

ì½”ë“œë¥¼ ì¢€ ì¤„ì—¬ë³´ì.

```swift
#Preview {
    @Previewable @State var place = Place.previewPlaces[0]
    
    MapView(place: place, position: .camera(MapCamera(
        centerCoordinate: place.location,
        distance: 1000,
        heading: 250,
        pitch: 80
    )))
}
```

![CleanShot 2024-09-10 at 00 18 59@2x](https://github.com/user-attachments/assets/6cd55adc-d2eb-4b41-97f9-7964b144fbd1)

ì°¸ê³ í•˜ì!

ì´ì œ bodyë¶€ë¶„ì„ ë³´ì™„í•˜ì.

ê°„ë‹¨í•˜ë‹¤. Map() ê´„í˜¸ ì•ˆì— ìœ„ì¹˜ë¥¼ ë„£ì–´ì£¼ë©´ ëœë‹¤.

```swift
struct MapView: View {
    
    var place: Place
    @State var position: MapCameraPosition
    
    var body: some View {
        Map(position: $position)
    }
}
```

![Sep-10-2024 00-21-05](https://github.com/user-attachments/assets/4f12d804-67c8-4504-a0ff-24cd704bf36f){: width="50%" height="50%"}


### 2. Annotation ì¶”ê°€í•˜ê¸°

```swift
struct MapView: View {
    
    var place: Place
    @State var position: MapCameraPosition
    
    var body: some View {
        Map(position: $position) {
            Annotation(place.intersted ? "Place of Interest" : "Not Interested", coordinate: place.location) {
                ZStack {
                    RoundedRectangle(cornerRadius: 7)
                        .fill(.ultraThickMaterial)
                        .stroke(.secondary, lineWidth: 5)
                    Image(systemName: place.intersted ? "face.smiling" : "hand.thumbsdown")
                }
            }
        }
    }
}
```

ì–´ë…¸í…Œì´ì…˜ì„ ê·¸ëƒ¥ ì¶”ê°€í•˜ë©´ ë˜ëŠ”ë° ì´ë•Œ ì•ì—ëŠ” titleì´ ë“¤ì–´ê°„ë‹¤.

ê·¸ë˜ì„œ interestedê°€ true / falseì— ë”°ë¼ ì´ë¦„ì´ ë‹¤ë¥´ê²Œ ë‚˜ì˜¤ê²Œ ì‚¼í•­ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ì˜€ê³ , ê·¸ë’¤ì—ëŠ” annotation pinì´ ë“¤ì–´ê°ˆ ì¢Œí‘œë¥¼ ì„¤ì •í•´ì¤€ë‹¤.

ì´í›„ Zstackì„ ì‚¬ìš©í•˜ì—¬ í•€ì˜ ì´ë¯¸ì§€ë¥¼ êµ¬í˜„í•˜ëŠ”ë° trueë©´ ì›ƒëŠ” í‘œì‹œ, falseë©´ ğŸ‘ í‘œì‹œê°€ ë‚˜ì˜¨ë‹¤.

![Sep-10-2024 00-28-22](https://github.com/user-attachments/assets/d55dc31f-a50b-4eae-bce3-7d7bcf606312){: width="50%" height="50%"}

### 3. í•€ í´ë¦­ì‹œ ê°’ ë³€ê²½í•˜ê¸°

`onTapGesture` ë¥¼ í†µí•´ì„œ í† ê¸€ì„ í•´ì£¼ë©´ ëœë‹¤.

```swift
struct MapView: View {
    
    var place: Place
    @State var position: MapCameraPosition
    
    var body: some View {
        Map(position: $position) {
            Annotation(place.intersted ? "Place of Interest" : "Not Interested", coordinate: place.location) {
                ZStack {
                    RoundedRectangle(cornerRadius: 7)
                        .fill(.ultraThickMaterial)
                        .stroke(.secondary, lineWidth: 5)
                    Image(systemName: place.intersted ? "face.smiling" : "hand.thumbsdown")
                        .padding(5)
                }
                .onTapGesture {
                    place.intersted.toggle()
                }
            }
        }
    }
}
```

![Sep-10-2024 00-30-33](https://github.com/user-attachments/assets/2217626c-73b6-440d-ac6d-051e3ce65af0){: width="50%" height="50%"}

ì´ë ‡ê²Œ í´ë¦­í•˜ë©´ í† ê¸€ë¡œ ì¸í•´ ê°’ì´ ë°”ë€Œë©´ì„œ ì´ë¯¸ì§€ì™€ titleë„ ê°™ì´ ë°”ë€Œê²Œ ëœë‹¤.

### 3. PlaceListì™€ ì—°ë™í•˜ê¸°

ë‹¤ì‹œ PlaceListë¡œ ëŒì•„ì™€ì„œ NavigationLinkë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.

```swift
NavigationStack {
            List ((try? places.filter(predicate)) ?? places) { place in
                NavigationLink(value: place) {
                    HStack {
                        place.image
                            .resizable()
                            .scaledToFit()
                            .clipShape(.rect(cornerRadius: 7))
                            .frame(width: 100, height: 100)
                        
                        Text(place.name)
                        
                        Spacer()
                        
                        if place.intersted {
                            Image(systemName: "star.fill")
                                .foregroundStyle(.yellow)
                                .padding(.trailing)
                        }
                    }
                }
            }
```

![Sep-10-2024 00-39-23](https://github.com/user-attachments/assets/45e4c0d7-8fdc-4a3f-83a6-d1c878f4bcb8){: width="50%" height="50%"}

í•˜ì§€ë§Œ ì•„ì§ ë„˜ì–´ê°€ì§€ëŠ” ì•ŠëŠ”ë‹¤.

ì™œëƒí•˜ë©´ **Destination**ì„ ì„¤ì •í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸

animation ë°‘ì— destinationì„ ì„¤ì •í•´ì£¼ì.

```swift
.navigationTitle("Places")
            .searchable(text: $searchText, prompt: "Find a Place")
            .animation(.default, value: searchText)
            .navigationDestination(for: Place.self) { place in
                MapView(place: place, position: .camera(MapCamera(
                    centerCoordinate: place.location,
                    distance: 1000,
                    heading: 250,
                    pitch: 80
                )))
            }
```

ì¹´ë©”ë¼ëŠ” ì•„ê¹Œ previewì— í–ˆë˜ ì„¸íŒ… ê·¸ëŒ€ë¡œ ê°’ì„ ê°€ì ¸ì™”ë‹¤.

![Sep-10-2024 00-42-33](https://github.com/user-attachments/assets/c735c84e-1f95-4062-b0e3-f8852b57638c){: width="50%" height="50%"}

ì´ë ‡ê²Œ í™”ë©´ì „í™˜ì´ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

í•˜ì§€ë§Œ í™”ë©´ì „í™˜ì‹œ Navigation Bar ì˜ì—­ì´ ë‚¨ì•„ìˆì–´ ì¢‹ì•„ë³´ì´ì§€ ì•ŠëŠ”ë‹¤.

MapViewë¡œ ê°€ì„œ

```swift
struct MapView: View {
    
    var place: Place
    @State var position: MapCameraPosition
    
    var body: some View {
        Map(position: $position) {
            Annotation(place.intersted ? "Place of Interest" : "Not Interested", coordinate: place.location) {
                ZStack {
                    RoundedRectangle(cornerRadius: 7)
                        .fill(.ultraThickMaterial)
                        .stroke(.secondary, lineWidth: 5)
                    Image(systemName: place.intersted ? "face.smiling" : "hand.thumbsdown")
                        .padding(5)
                }
                .onTapGesture {
                    place.intersted.toggle()
                }
            }
        }
        .toolbarBackground(.automatic)
    }
}
```

toolbarBackgroundì— ëŒ€í•´ automaticallyë¡œ ì‘ë™í•˜ê²Œ ì„¤ì •ì„ í•œë‹¤.

ì—¬ê¸° Previewì—ì„œëŠ” ë³€í™”ë¥¼ ê°ì§€í•˜ì§€ ëª»í•œë‹¤.

ë‹¤ì‹œ PlaceListì—ì„œ í™•ì¸ì„ í•´ë³´ë©´

![Sep-10-2024 00-53-23](https://github.com/user-attachments/assets/8e89eb40-e21f-4bb1-9bae-b0067b8dec0a){: width="50%" height="50%"}

ì´ë ‡ê²Œ ì‘ë™ì´ ë˜ê³ , ë˜í•œ interestedë„ ë°˜ì˜ì´ ë˜ëŠ”ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

Swift dataì˜ ì¥ì ì´ ì—¬ê¸°ì„œ ë‚˜ì˜¨ë‹¤.

Swift ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ê³  ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ë©´ ë‹¤ìŒ ì¤‘ í•˜ë‚˜ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.

â†’ ê°’ì´ ë°”ë€Œë©´ ëª¨ë“  ê³³ì—ì„œ ë°”ë€ë‹¤!
â†’ ë™ì¼í•œ ê°’ì´ê³  ë™ì¼í•œ ì†ì„±ì´ê¸° ë•Œë¬¸ì— ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ í•´ë‹¹ ê°’ì„ ì°¸ì¡°í•œë‹¤.

### 4. ë¶€ëª¨, ìì‹ë·°ë¥¼ í™œìš©í•˜ì—¬ ë³´ì™„í•˜ê¸°

```swift
var body: some View {
        NavigationStack {
            List ((try? places.filter(predicate)) ?? places) { place in
                NavigationLink(value: place) {
                    HStack {
                        place.image
                            .resizable()
                            .scaledToFit()
                            .clipShape(.rect(cornerRadius: 7))
                            .frame(width: 100, height: 100)
                        
                        Text(place.name)
                        
                        Spacer()
                        
                        if place.intersted {
                            Image(systemName: "star.fill")
                                .foregroundStyle(.yellow)
                                .padding(.trailing)
                        }
                    }
                }
                .matchedTransitionSource(id: 1, in: namespace) // added
            }
            .navigationTitle("Places")
            .searchable(text: $searchText, prompt: "Find a Place")
            .animation(.default, value: searchText)
            .navigationDestination(for: Place.self) { place in
                MapView(place: place, position: .camera(MapCamera(
                    centerCoordinate: place.location,
                    distance: 1000,
                    heading: 250,
                    pitch: 80
                )))
                .navigationTransition(.zoom(sourceID: 1, in: namespace)) // added
            }
            .toolbar {
                ToolbarItem(placement: .topBarTrailing) {
                    Button("Show Images", systemImage: "photo") {
                        showImages.toggle()
                    }
                    .sheet(isPresented: $showImages) {
                        Scrolling()
                    }
                }
                
                ToolbarItem(placement: .topBarLeading) {
                    Button("filter", systemImage: filterByInterested ? "star.fill" : "star") {
                        withAnimation {
                            filterByInterested.toggle()
                        }
                    }
                    .tint(filterByInterested ? .yellow : .blue)
                }
            }
        }
    }
```

ê·¸ë¦¬ê³  ` @Namespace var namespace`ë¥¼ ì¶”ê°€í•´ì£¼ì—ˆë‹¤.

![CleanShot 2024-09-10 at 01 01 57@2x](https://github.com/user-attachments/assets/274bb4e3-7299-4c86-857e-3e4a70a1bf10)

namespaceì™€ idëŠ” SwiftUIì—ì„œ ì• ë‹ˆë©”ì´ì…˜ ë° ë·° ê°„ ì „í™˜(transition) íš¨ê³¼ë¥¼ ì •ì˜í•  ë•Œ ì‚¬ìš©ë˜ëŠ” ìš”ì†Œë“¤ì´ë‹¤. namespaceëŠ” ë·° ê°„ì˜ ì¼ê´€ëœ ì• ë‹ˆë©”ì´ì…˜ì„ ê´€ë¦¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ê³ , idëŠ” ì „í™˜ íš¨ê³¼ê°€ ì ìš©ë  ëŒ€ìƒ ë·°ë¥¼ ì‹ë³„í•˜ê¸° ìœ„í•´ ì‚¬ìš©ëœë‹¤.

`@Namespace`
- ì„¤ëª…: @NamespaceëŠ” SwiftUIì—ì„œ ë·° ê°„ì˜ ì• ë‹ˆë©”ì´ì…˜ ì „í™˜ì„ ì¼ê´€ë˜ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ì†ì„±ì´ë‹¤. ì„œë¡œ ë‹¤ë¥¸ ë·°ê°€ ê°™ì€ namespaceë¥¼ ê³µìœ í•˜ê²Œ ë˜ë©´ SwiftUIëŠ” ë·° ê°„ì˜ ìƒíƒœ ë³€í™”ì— ëŒ€í•´ ìì—°ìŠ¤ëŸ¬ìš´ ì „í™˜ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.
- ìš©ë„: ë·° ì „í™˜ ì‹œ matchedGeometryEffect ë˜ëŠ” matchedTransitionSourceì™€ ê°™ì€ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ë•Œ @Namespaceë¥¼ ì‚¬ìš©í•œë‹¤.

`id`
- ì„¤ëª…: idëŠ” íŠ¹ì • ì „í™˜ íš¨ê³¼ë‚˜ ì• ë‹ˆë©”ì´ì…˜ì´ ì ìš©ë  ë·°ë¥¼ ì‹ë³„í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ê³ ìœ í•œ ì‹ë³„ìì´ë‹¤. ê°™ì€ namespace ë‚´ì—ì„œ idê°€ ë™ì¼í•œ ë‘ ë·°ëŠ” ì „í™˜ ì¤‘ì— ì„œë¡œ ì—°ê²°ë˜ì–´ ìì—°ìŠ¤ëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜ì„ ì œê³µí•  ìˆ˜ ìˆë‹¤.
- ìš©ë„: SwiftUIì—ì„œ matchedTransitionSource ë° matchedTransitionDestinationì™€ ê°™ì€ ìˆ˜ì‹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • idë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë·° ê°„ì˜ ì „í™˜ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

![Sep-10-2024 01-03-11](https://github.com/user-attachments/assets/60f326c3-49d1-4c2c-ab2a-5d02b5c9a10b){: width="50%" height="50%"}

ì´ë ‡ê²Œ í´ë¦­ì‹œ í™”ë©´ì „í™˜ì´ ë°”ë€ê±¸ ì•Œ ìˆ˜ ìˆë‹¤.

### 5. SwipeAction ì¶”ê°€í•˜ê¸°

```swift
.matchedTransitionSource(id: 1, in: namespace)
                .swipeActions(edge: .leading) {
                    Button(place.interested ? "Interested" : "Not Interested", systemImage: "star") {
                        place.interested.toggle()
                    }
                }
                .tint(place.interested ? .yellow : .gray)
```

ì´ë ‡ê²Œ ë°‘ì— swipeActionì„ ì¶”ê°€í•˜ê³  ë²„íŠ¼ì„ ë§Œë“¤ì–´ ì¤€ë‹¤.

![Sep-10-2024 01-33-15](https://github.com/user-attachments/assets/e7ffb937-d0aa-4c48-9703-3d05ad31412c){: width="50%" height="50%"}

ì‘ë™ì´ ì˜ ë˜ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

