---
title: BB Quotes (1)
writer: Harold
date: 2025-4-29 7:33:00 +0800
categories: [Udemy, SwiftUI]
tags: [SwiftUI]

toc: true
toc_sticky: true
---

ì´ë²ˆ ë‚´ìš©ë„ ì•„ëŠ”ê±´ ìµœëŒ€í•œ ê°„ëµí•˜ê²Œ í•˜ê³  ê³¼ì •ì„ ì ì–´ë³¸ë‹¤.

## TabView ì‚¬ìš©í•˜ê¸°

ì´ë²ˆì—” ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ ì•±ì„ ë§Œë“¤ë©´ì„œ TabViewë¥¼ ì‚¬ìš©í•´ë³¸ë‹¤.

ì´ì „ì— ë§ì´ ì‚¬ìš©í•´ë´ì„œ ë­ ë”±íˆ ì ì„ë§Œí•œê±´ ì—†ì–´ë³´ì´ê¸´í•œë‹¤.

```swift
var body: some View {
    TabView {
        Tab("Breaking Bad", systemImage: "tortoise") {
            Text("Breaking Bad View")
        }
        
        Tab("Better Call Saul", systemImage: "briefcase") {
            Text("Better Call Saul View")
        }
    }
}
```

ì´ë ‡ê²Œ ê°„ë‹¨í•˜ê²Œ ë§Œë“¤ì–´ ì£¼ì—ˆë‹¤.

![Image](https://github.com/user-attachments/assets/ba45f564-1ade-4868-bf37-46ea848fa076){: width="50%" height="50%"} 

ì´ë ‡ê²Œ ë§Œë“¤ì–´ ì¡Œë‹¤.

ì´ë•Œ TabBarìª½ì— ì•½ê°„ì˜ Backgroundë¥¼ ë§Œë“¤ì–´ì£¼ê³  ì‹¶ë‹¤ë©´

```swift
Tab("Breaking Bad", systemImage: "tortoise") {
    Text("Breaking Bad View")
        .toolbarBackgroundVisibility(.visible, for: .tabBar)
}
```

ì´ë ‡ê²Œ ` .toolbarBackgroundVisibility` Modifierë¥¼ ì‚¬ìš©í•´ì£¼ë©´ ëœë‹¤.

- Modifier âŒ
![Image](https://github.com/user-attachments/assets/8cfa3476-2645-4dbe-a0d8-e2f090119850){: width="50%" height="50%"}
- Modifier â­•ï¸
![Image](https://github.com/user-attachments/assets/8100b10f-c80f-4f9c-991f-816582889291){: width="50%" height="50%"} 

í™•ì‹¤íˆ ë‹¤ë¥¸ê±¸ ì•Œ ìˆ˜ ìˆë‹¤.

## ëª¨ë¸ë§

ìš°ì„  json sample íŒŒì¼ë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ëª¨ë¸ë§ì„ í•œë‹¤.

ì´ë¶€ë¶„ì€ ì½”ë“œë§Œ ì„œìˆ í•˜ëŠ”ê±¸ë¡œ...

```swift
struct Char: Decodable {
    let name: String
    let birthday: String
    let occupations: [String]
    let images: [URL]
    let aliases: [String]
    let status: String
    let portrayedBy: String
    var death: Death?
}

struct Quote: Decodable {
    let quote: String
    let character: String
}

struct Death: Decodable {
    let character: String
    let image: URL
    let details: String
    let lastWords: String
}
```

ì¤€ë¹„ ì™„ë£Œ.

## Concurrency

ì´ê±´ ì „ì— [Async/Await](https://haroldfromk.github.io/categories/concurrency/){:target="_blank"} í•˜ë©´ì„œ ì •ë¦¬ë¥¼ í–ˆì—ˆê¸°ì— ê·¸ê±¸ ë‹¤ì‹œë³´ë©° ë¦¬ë§ˆì¸ë“œë¥¼ í•˜ëŠ”ê²Œ ì¢‹ë‹¤.

```swift
struct FetchService {
    enum FetchError: Error {
        case badResponse
    }
    
    let baseURL = URL(string: "https://breaking-bad-api-six.vercel.app/api")!
    
    func fetchQuote(from show: String) async throws -> Quote {
        // Build fetch url
        let quoteURL = baseURL.appending(path: "quotes/random")
        let fetchURL = quoteURL.appending(queryItems: [URLQueryItem(name: "production", value: show)])
        
        // Fetch data
        let (data, response) = try await URLSession.shared.data(from: fetchURL)
        
        // Handle response
        guard let response = response as? HTTPURLResponse, response.statusCode == 200 else {
            throw FetchError.badResponse
        }
        
        // Decode dta
        let quote = try JSONDecoder().decode(Quote.self, from: data)
        
        // Return quote
        return quote
    }
    
    func fetchCharacter(_ name: String) async throws -> Char {
        let characterURL = baseURL.appending(path: "characters")
        let fetchURL = characterURL.appending(queryItems: [URLQueryItem(name: "name", value: name)])
        
        let (data, response) = try await URLSession.shared.data(from: fetchURL)
        
        guard let response = response as? HTTPURLResponse, response.statusCode == 200 else {
            throw FetchError.badResponse
        }
        
        let decoder = JSONDecoder()
        decoder.keyDecodingStrategy = .convertFromSnakeCase
        
        let characters = try decoder.decode([Char].self, from: data)
        
        return characters[0]
    }
    
    func fetchDeath(for character: String) async throws -> Death? {
        let fetchURL = baseURL.appending(path: "deaths")
        
        let (data, response) = try await URLSession.shared.data(from: fetchURL)
        
        guard let response = response as? HTTPURLResponse, response.statusCode == 200 else {
            throw FetchError.badResponse
        }
        
        let decoder = JSONDecoder()
        decoder.keyDecodingStrategy = .convertFromSnakeCase
        
        let deaths = try decoder.decode([Death].self, from: data)
        
        for death in deaths {
            if death.character == character {
                return death
            }
        }
        
        return nil
    }
    
}
```

ìœ„ì™€ ê°™ì´ fetch ê¸°ë³¸ ì½”ë“œë¥¼ ì‘ì„±í•´ì¤€ë‹¤.

ì´ë•Œ ë‚¯ì´ ìµì€ ì½”ë“œ ì „ê°œê°€ ìˆëŠ”ë° ë°”ë¡œ [ì´ì „ê¸€](https://haroldfromk.github.io/posts/BookStore_1/){:target="_blank"}ì—ì„œ Genericì„ ì‚¬ìš©í•˜ë©´ì„œ Fetch Codeë¥¼ ì‘ì„±í–ˆë˜ê²Œ ë– ì˜¬ëë‹¤. ì´ì „ê¸€ì„ ì°¸ê³ í•˜ë©´ì„œ ë¦¬ë§ˆì¸ë“œí•˜ë©´ ì¢‹ë‹¤.

## View Model ë§Œë“¤ê¸°

MVVM Patternì—ì„œ ì‚¬ìš©ë˜ëŠ” ë°©ì‹

ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ì„œ

```swift
@Observable
@MainActor
class ViewModel {
    enum FetchStatus {
        case notStarted
        case fetching
        case success
        case failed(error: Error)
    }
    
    private(set) var status: FetchStatus = .notStarted
    
    private let fetcher = FetchService()
    
    var quote: Quote
    var character: Char
    
    init() {
        
    }
}
```

ì—¬ê¸°ê¹Œì§€ ì½”ë“œê°€ ì‘ì„± ë˜ì—ˆëŠ”ë°, ë” ì½”ë“œë¥¼ ì¶”ê°€í•˜ê¸° ì „ì— ì§šê³  ë„˜ì–´ê°ˆê²Œ ìˆì–´ì„œ ì ì–´ë³¸ë‹¤.

ìš°ì„  `@Observable, @MainActor` ì´ 2ê°œëŠ” [ì´ì „ì—](https://haroldfromk.github.io/posts/Async_await-(4)/){:target="_blank"} ì–¸ê¸‰ì„ í•œì ì´ ìˆë‹¤. ì°¸ê³ í•˜ë©´ ì¢‹ì„ ë“¯

ê·¸ë¦¬ê³  ì—¬ê¸°ì„œ ìš°ë¦¬ê°€ ì˜ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ë˜ `private(set)`ì´ ë‚˜ì˜¨ë‹¤.

---

### ğŸ”’ `private(set)` ì ‘ê·¼ ì œì–´ì

`private(set)`ì€ Swiftì—ì„œ **ì™¸ë¶€ì—ì„œëŠ” ì½ê¸°ë§Œ ê°€ëŠ¥í•˜ê³ , ë‚´ë¶€ì—ì„œëŠ” ì½ê³  ì“¸ ìˆ˜ ìˆëŠ”** ì†ì„±ì„ ë§Œë“¤ ë•Œ ì‚¬ìš©ëœë‹¤.

#### âœ… ê¸°ë³¸ ê°œë…
- `set`ì„ privateìœ¼ë¡œ ì œí•œí•˜ì§€ë§Œ  
- `get`ì€ publicìœ¼ë¡œ í—ˆìš©ëœë‹¤.

ì¦‰, ì™¸ë¶€ì—ì„œëŠ” **ê°’ì„ ì½ì„ ìˆ˜ëŠ” ìˆì§€ë§Œ ìˆ˜ì •í•  ìˆ˜ëŠ” ì—†ë‹¤.**  
ë°˜ë©´, ì„ ì–¸ëœ ë‚´ë¶€(`struct`, `class` ë“±)ì—ì„œëŠ” **ì½ê³  ì“¸ ìˆ˜ ìˆë‹¤.**

---

#### ğŸ’¡ ì‚¬ìš© ì˜ˆì‹œ

```swift
@Observable  
@MainActor  
class ViewModel {  
â€ƒâ€ƒprivate(set) var fetchStatus: FetchStatus = .notStarted  
}
```

- ì™¸ë¶€ ë·°ëŠ” `fetchStatus` ê°’ì„ **ì½ì„ ìˆ˜ëŠ” ìˆì§€ë§Œ**
- **ì§ì ‘ ë³€ê²½(set)ì€ í•  ìˆ˜ ì—†ìŒ**
- ê°’ ë³€ê²½ì€ ViewModel ë‚´ë¶€ì—ì„œë§Œ ê°€ëŠ¥

---

#### ğŸ” ì™œ ì‚¬ìš©í•˜ë‚˜?

- **ë³´ì•ˆ**: ì™¸ë¶€ì—ì„œ ì¤‘ìš”í•œ ì†ì„±ì„ ë¬´ë¶„ë³„í•˜ê²Œ ë³€ê²½í•˜ì§€ ëª»í•˜ë„ë¡ ë³´í˜¸  
- **ì˜ˆì¸¡ ê°€ëŠ¥ì„±**: ìƒíƒœ(state) ë³€ê²½ì„ **ViewModel ë‚´ë¶€ì—ì„œë§Œ** ê´€ë¦¬í•˜ë„ë¡ ì œí•œí•˜ì—¬ **ë²„ê·¸ë¥¼ ì¤„ì„**

---

#### ğŸ“Œ ìš”ì•½

| ì ‘ê·¼ ì œì–´ì     | ì™¸ë¶€ì—ì„œ ì½ê¸° | ì™¸ë¶€ì—ì„œ ì“°ê¸° | ë‚´ë¶€ì—ì„œ ì½ê¸°/ì“°ê¸° |
|----------------|---------------|----------------|------------------|
| `private`      | âŒ            | âŒ             | âœ…               |
| `public`       | âœ…            | âœ…             | âœ…               |
| `private(set)` | âœ…            | âŒ             | âœ…               |

ë”°ë¼ì„œ, `private(set)`ì€ **ìƒíƒœë¥¼ ì™¸ë¶€ì— ë…¸ì¶œí•˜ë˜ ë³€ê²½ì€ ë§‰ê³  ì‹¶ì„ ë•Œ** ì‚¬ìš©í•˜ëŠ” íš¨ê³¼ì ì¸ ë°©ë²•ì´ë‹¤.

---

### SampleData ê°€ì ¸ì˜¤ê¸°

ê·¸ë¦¬ê³  class typeì—ì„œëŠ” Initializerê°€ ì—†ê¸°ì—

```swift
var quote: Quote
var character: Char
```

ì´ë ‡ê²Œ ì‚¬ìš©í•  ìˆ˜ê°€ ì—†ë‹¤.

ê·¸ë˜ì„œ `init() {}` í†µí•´ ì´ˆê¸°í™”ë¥¼ í•´ì¤€ë‹¤.

```swift
init() {
    let decoder = JSONDecoder()
    decoder.keyDecodingStrategy = .convertFromSnakeCase
    
    let quoteData = try! Data(contentsOf: Bundle.main.url(forResource: "samplequote", withExtension: "json")!)
    quote = try! decoder.decode(Quote.self, from: quoteData)
    
    let characterData = try! Data(contentsOf: Bundle.main.url(forResource: "samplecharacter", withExtension: "json")!)
    character = try! decoder.decode(Char.self, from: characterData)
}
```

- ğŸ” ViewModelì˜ `init()`ì—ì„œ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì§ì ‘ ë””ì½”ë”©í•œ ì´ìœ 
  - `Quote`ì™€ `Char`ëŠ” ì•± ì‹¤í–‰ ì‹œ í•„ìš”í•œ **ì´ˆê¸° ë°ì´í„°**ë¥¼ ë‹´ê³  ìˆìŒ  
  - ì‹¤ì œ ë„¤íŠ¸ì›Œí¬ í†µì‹  ì—†ì´ë„ **Preview ë° UI í…ŒìŠ¤íŠ¸**ê°€ ê°€ëŠ¥í•˜ë„ë¡ í•˜ê¸° ìœ„í•¨  
  - íŠ¹íˆ `Char`ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ `sampledeath.json`ê¹Œì§€ í¬í•¨ë˜ê¸° ë•Œë¬¸ì—  
    death ì •ë³´ê¹Œì§€ ê°–ì¶˜ **ì™„ì„±ëœ ìƒ˜í”Œ ë°ì´í„°ë¥¼ êµ¬ì„±**í•  ìˆ˜ ìˆìŒ  
    â†’ death ì •ë³´ëŠ” ì•„ë˜ì—ì„œ `init` ì„ í†µí•´ ê°€ì ¸ì˜¬ ì˜ˆì •
  - ë”°ë¼ì„œ ViewModelì˜ ì´ˆê¸°í™” ì‹œì ì—ì„œ  
    `samplequote.json`, `samplecharacter.json`ì„ ì§ì ‘ ë””ì½”ë”©í•˜ì—¬  
    Viewê°€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” **ëª¨ì˜ ë°ì´í„°(mock data)**ë¥¼ ì„¸íŒ…í•œ ê²ƒì´ë‹¤

ê·¸ë¦¬ê³  Char.swiftë¡œ ê°€ì„œë„ initì„ í•´ì¤€ë‹¤.

ì´ë•Œ

![Image](https://github.com/user-attachments/assets/3bb8c590-c786-40b5-b1fd-994be6401543)

ì²«ë²ˆì§¸ë¥¼ ì„ íƒí•˜ì—¬ ìë™ì™„ì„±ì„ í•´ì£¼ì.

```swift
struct Char: Decodable {
    // ìƒëµ
    
    enum CodingKeys: CodingKey {
        // ìƒëµ
    }
    
    init(from decoder: any Decoder) throws {
        // ìƒëµ
        let deathDecoder = JSONDecoder()
        deathDecoder.keyDecodingStrategy = .convertFromSnakeCase

        let deathData = try Data(contentsOf: Bundle.main.url(forResource: "sampledeath", withExtension: "json")!)
        death = try deathDecoder.decode(Death.self, from: deathData)
    }
}
```

ì´ë•Œ initì„ í†µí•´ ë§Œë“¤ì–´ì§„ death ê´€ë ¨ ì½”ë“œëŠ” ì§€ìš°ê³  ì´ë ‡ê²Œ ì§ì ‘ initializingì„ í•´ì¤€ë‹¤.

- â˜ ï¸ `death`ë¥¼ `Char`ì˜ `init(from:)`ì—ì„œ ìˆ˜ë™ìœ¼ë¡œ ì´ˆê¸°í™”í•œ ì´ìœ 
  - `Char` ëª¨ë¸ì€ `let death: Death?` ì˜µì…”ë„ í”„ë¡œí¼í‹°ë¥¼ í¬í•¨í•˜ê³  ìˆìŒ  
    â†’ ì¦‰, ì£½ì€ ìºë¦­í„°ëŠ” death ì •ë³´ê°€ ìˆê³ , ì‚´ì•„ìˆëŠ” ìºë¦­í„°ëŠ” `nil`
  - í•˜ì§€ë§Œ `samplecharacter.json`ì—ëŠ” `death`ì— ëŒ€í•œ ì •ë³´ê°€ ì—†ìŒ  
    â†’ decoderëŠ” ê¸°ë³¸ì ìœ¼ë¡œ JSONì— ì—†ëŠ” í‚¤ëŠ” `nil`ë¡œ ì²˜ë¦¬í•¨
  - ë¬¸ì œ: death ì •ë³´ë¥¼ Previewë‚˜ ìƒ˜í”Œ ë°ì´í„°ì—ì„œ **ë³´ì—¬ì£¼ê³  ì‹¶ì€ ê²½ìš°**,  
    ë³„ë„ë¡œ `sampledeath.json`ì„ ë””ì½”ë”©í•´ì„œ **Charì˜ `death`ì— ìˆ˜ë™ìœ¼ë¡œ ë„£ì–´ì•¼ í•¨**
  - ê·¸ë˜ì„œ `Char`ì˜ `init(from:)` ë‚´ë¶€ì—ì„œ deathë¥¼  
    `sampledeath.json`ì—ì„œ ë””ì½”ë”©í•˜ì—¬ ìˆ˜ë™ìœ¼ë¡œ ì„¤ì •í•œ ê²ƒ

ğŸ“Œ ì •ë¦¬:
- **ì‹¤ì œ ì•± ë™ì‘**ì—ì„œëŠ” ë„¤íŠ¸ì›Œí¬ì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ ì¡°í•©
- **ìƒ˜í”Œ ë° í”„ë¦¬ë·°ìš©**ì—ì„œëŠ” death ë°ì´í„°ë¥¼ ë”°ë¡œ ë¯¸ë¦¬ ë¶ˆëŸ¬ì™€  
  character ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì‹œ í•¨ê»˜ ì´ˆê¸°í™”í•´ ë³´ì—¬ì£¼ê¸° ìœ„í•´ initì—ì„œ ì²˜ë¦¬í•¨