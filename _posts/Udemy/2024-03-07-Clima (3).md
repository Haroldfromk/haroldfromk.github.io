---
title: Clima (3)
writer: Harold
date: 2024-03-07 11:21:00 +0800
#last_modified_at: 2024-03-06 11:11:00 +0800
categories: [Udemy, Clima]
tags: [API, Networking]

toc: true
toc_sticky: true
---

## ë‚ ì”¨ ìƒíƒœì— ë”°ë¥¸ ImageView Update

ìš°ì„  ì›¹í˜ì´ì§€ë¥¼ ë‹¤ì‹œ ë“¤ì–´ê°€ì„œ Weather APIì— ê´€í•œ Docsë¥¼ ì½ì–´ë³´ì.

![](https://i.esdrop.com/d/f/E8Nib9NqGY/C1EK5sW8v5.png)

ìš°ë¦¬ê°€ ë´ì•¼í• ê±´ ì˜¤ë¥¸ìª½ì— ë°‘ì¤„ ì¹œ ë¶€ë¶„ì´ë‹¤.

ë‚´ìš©ì´ ë§ì•„ ë§í¬ë¥¼ ê±´ë‹¤.

<https://openweathermap.org/weather-conditions>


ì¼ë‹¨ ìƒ˜í”Œì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´.

```
... 
  "weather": [
	{
	  "id": 500, // idì— ë”°ë¼ ì–´ë–¤ ì´ë¯¸ì§€ë¥¼ ë³´ì—¬ì£¼ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤.
	  "main":"Rain",
	  "description": "light rain",
	  "icon": "10n"
	}
  ],
...
```

ê·¸ë˜ì„œ id ê°’ì„ ì¶”ì¶œ í•˜ê¸° ìœ„í•´ WeatherDataë¡œ ê°€ì„œ

ê°’ì„ ì¶”ê°€í•´ì¤€ë‹¤.

```swift
struct Weather : Decodable {
    let description : String
    let id : Int // ì´ë…€ì„ì´ë‹¤.
}

```

ì‹¤ì œë¡œ idê°€ ì¶œë ¥ë˜ëŠ”ì§€ í™•ì¸í•´ë³´ì!

ë°œë¦¬ì˜ idë¥¼ í™•ì¸í•´ë³´ì

![](https://i.esdrop.com/d/f/E8Nib9NqGY/TjhhtVRjoQ.gif)

ì˜ë‚˜ì˜¤ê³  ìˆë‹¤!

ê·¸ë ‡ë‹¤ë©´ ì´ idê°’ì„ í†µí•´ ìš°ë¦¬ê°€ ê²°êµ­ SF Symbolì˜ ì´ë¦„ì„ ë¦¬í„´í•´ì„œ imageViewë¥¼ ë°”ê¿”ì•¼ í•œë‹¤.

![](https://i.esdrop.com/d/f/E8Nib9NqGY/qeLQ7ELybg.png)

idê°’ì„ í†µí•´ ì € ì´ë¦„ì„ ë¦¬í„´í•˜ê²Œë” ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ì!

``` swift
func getConditionName(weatherId: Int) -> String {
        
        return ""
    }
```

ìš°ì„  ê¸°ë³¸ í‹€ì„ ì‘ì„±í•´ë‘”ë‹¤.

ì›¹í˜ì´ì§€ë¥¼ ì°¸ê³ í•˜ì—¬ ê° ìˆ«ì ì¡°ê±´ì— ë§ê²Œ sf symbolì„ ë¦¬í„´í•  ë¡œì§ì„ êµ¬í˜„í•˜ì˜€ë‹¤.

```swift
   func getConditionName(weatherId: Int) -> String {
        var conditionName = ""
        
        switch weatherId {
            case 200...232 : conditionName = "cloud.bolt"
            case 300...321 : conditionName = "cloud.drizzle"
            case 500...531 : conditionName = "cloud.rain"
            case 600...622 : conditionName = "cloud.snow"
            case 700...781 : conditionName = "cloud.fog"
            case 800 : conditionName = "sun.max"
            case 801...804 : conditionName = "cloud.bolt"
            default : conditionName = "cloud"
        }
        return conditionName
    }
```

ë˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸ í•´ë³´ì ë‹¤ì‹œ ë°œë¦¬ë¥¼ í–ˆì„ë•Œ ì–´ë–»ê²Œ ë‚˜ì˜¤ëŠ”ì§€ í•´ë³´ì

804ê°€ ë‚˜ì™”ìœ¼ë‹ˆê¹Œ ì œëŒ€ë¡œ ì‘ë™ëœë‹¤ë©´ "cloud.bolt"ê°€ ë‚˜ì˜¬ê²ƒì´ë‹¤.

![](https://i.esdrop.com/d/f/E8Nib9NqGY/myo4DxxaJI.png){: width="50%" height="50%"} 

êµ¿!

ì ì  ë³µì¡í•´ì§€ê¸° ì‹œì‘í•œë‹¤

## ì‚¬ìš©ì ì§€ì • íƒ€ì…ìœ¼ë¡œ ì¼ë¶€ ë°ì´í„° ê·¸ë£¹í™”í•˜ê¸°

Weather Model íŒŒì¼ì„ í•˜ë‚˜ ë§Œë“¤ì–´ì¤€ë‹¤.

```swift
struct WeatherModel {
    let conditionId : Int
    let cityName : String
    let temperature : Double
}

```

ê·¸ë¦¬ê³  ë‹¤ìŒê³¼ ê°™ì´ ì ì–´ì£¼ì—ˆë‹¤.

ì € ë³€ìˆ˜ë“¤ì€ ì‹¤ì œ ìš°ë¦¬ê°€ í™”ë©´ì— ë³´ì—¬ì¤„ë•Œ í•„ìš”í•œ ê°’ë“¤ì´ë‹¤.

ê·¸ë¦¬ê³  ì•„ê¹Œ ì ì—ˆë˜ í•¨ìˆ˜ë¥¼ Modelë¡œ ì˜®ê²¨ì¤€ë‹¤

```swift
struct WeatherModel {
   
    let conditionId : Int
    let cityName : String
    let temperature : Double
    
    func getConditionName(weatherId: Int) -> String {
        var conditionName = ""
        
        switch weatherId {
            case 200...232 : conditionName = "cloud.bolt"
            case 300...321 : conditionName = "cloud.drizzle"
            case 500...531 : conditionName = "cloud.rain"
            case 600...622 : conditionName = "cloud.snow"
            case 700...781 : conditionName = "cloud.fog"
            case 800 : conditionName = "sun.max"
            case 801...804 : conditionName = "cloud.bolt"
            default : conditionName = "cloud"
        }
        return conditionName
    }
    
}
```

ë‹¤ì‹œ Managerë¡œ ëŒì•„ê°€ì„œ

id temp nameê³¼ ê´€ë ¨ëœ ë³€ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤.

```swift
let id = decodedData.weather[0].id
let temp = decodedData.main.temp
let name = decodedData.name
```

ê·¸ë¦¬ê³  ì¢€ì „ì— ë§Œë“¤ì—ˆë˜ WeatherModelì„ Instanceí™” í•œë‹¤.

`let weather = WeatherModel(conditionId: id, cityName: name, temperature: temp)`

ê·¸ë¦¬ê³  í•¨ìˆ˜ë¥¼ ì§€ìš°ê³  ë‹¤ìŒê³¼ ê°™ì´ í•´ì£¼ì—ˆë‹¤.

```swift
struct WeatherModel {
    
    let conditionId : Int
    let cityName : String
    let temperature : Double
    
    var conditionName : String {
        switch conditionId {
        case 200...232 :
            return "cloud.bolt"
        case 300...321 :
            return "cloud.drizzle"
        case 500...531 :
            return "cloud.rain"
        case 600...622 :
            return "cloud.snow"
        case 700...781 :
            return "cloud.fog"
        case 800 :
            return "sun.max"
        case 801...804 :
            return "cloud.bolt"
        default :
            return "cloud"
        }
    }
        
}
```
ì´ëŸ°ì‹ìœ¼ë¡œ conditionName ì²˜ëŸ¼ ì €ë ‡ê²Œ í•˜ëŠ”ê±¸ Computed Property(ì—°ì‚° í”„ë¡œí¼í‹°) ë¼ê³  í•œë‹¤.

ê·¸ë ‡ë‹¤ë©´ ì˜¨ë„ë¥¼ ì†Œìˆ˜ì  í•œìë¦¬ë¡œ ë‚˜íƒ€ë‚˜ê²Œ í•´ë³´ì!

```swift
var temperatureString : String {
        return String(format: "%.1f", temperature)
    }
```
ì´ë ‡ê²Œ ì‘ì„±í•´ì£¼ì—ˆë‹¤.

![](https://i.esdrop.com/d/f/E8Nib9NqGY/1gI9HjwXkd.png)

ì˜ ë‚˜ì˜¨ë‹¤ ğŸ˜€