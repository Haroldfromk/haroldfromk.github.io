<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="ko-KR" >
  <head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4791588234419923"
     crossorigin="anonymous"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="10주차 과제 (10)" />
<meta property="og:locale" content="ko_KR" />
<meta name="description" content="예외처리도 끝났고, 남은건 내가 원래 과제에서 제출하고자 했던" />
<meta property="og:description" content="예외처리도 끝났고, 남은건 내가 원래 과제에서 제출하고자 했던" />
<link rel="canonical" href="http://localhost:4000/posts/10%EC%A3%BC%EC%B0%A8-%EA%B3%BC%EC%A0%9C-(10)/" />
<meta property="og:url" content="http://localhost:4000/posts/10%EC%A3%BC%EC%B0%A8-%EA%B3%BC%EC%A0%9C-(10)/" />
<meta property="og:site_name" content="Harold`s DLog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-05-11T04:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="10주차 과제 (10)" />
<meta name="twitter:site" content="@twitter_username" />
<meta name="google-site-verification" content="AW90BDnepHsDdmQ6OaGtfM4bGYM_XM-4atRcFmERHVY" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-05-11T04:00:00+09:00","datePublished":"2024-05-11T04:00:00+09:00","description":"예외처리도 끝났고, 남은건 내가 원래 과제에서 제출하고자 했던","headline":"10주차 과제 (10)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/10%EC%A3%BC%EC%B0%A8-%EA%B3%BC%EC%A0%9C-(10)/"},"url":"http://localhost:4000/posts/10%EC%A3%BC%EC%B0%A8-%EA%B3%BC%EC%A0%9C-(10)/"}</script>
<!-- End Jekyll SEO tag -->


  <title>10주차 과제 (10) | Harold`s DLog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Harold`s DLog">
<meta name="application-name" content="Harold`s DLog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    
      <link rel="preconnect" href="https://polyfill.io" >
      <link rel="dns-prefetch" href="https://polyfill.io" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }
          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();
      });
    } /* constructor() */

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isSysDarkPrefer() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get isLightMode() {
      return this.mode === ModeToggle.LIGHT_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }
        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }
      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    } /* flipMode() */
  } /* ModeToggle */

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->
<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
  <!-- .sidebar-badge -->
    <a href="/" id="avatar" class="rounded-circle"><img src="https://i.ibb.co/SQtS8n8/avatar.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">Harold`s DLog</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">토프레와 애플을 좋아하는 사람의 Daily, Dev Log</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>홈</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>카테고리</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>태그</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>아카이브</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>정보</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>
  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/haroldfromk"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['dongik369','naver.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">홈</a>
            </span>

          
        
          
        
          
            
              <span>10주차 과제 (10)</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      포스트
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="검색..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">취소</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>10주차 과제 (10)</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        게시
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1715367600"
  data-df="YYYY/MM/DD"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  2024/05/11
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/haroldfromk">Dongik Song</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="3949 단어"
>
  <em>21 분</em>읽는 시간</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    <p>예외처리도 끝났고, 남은건 내가 원래 과제에서 제출하고자 했던</p>

<p>DataSource → DiffableDataSource의 변환과,</p>

<p>튜터님의 피드백인 VM에서 Network 와, Coredata 함수의 분리를 하고 이번 과제의 종점을 찍으려 한다.</p>

<h2 id="datasource--diffabledatasource로-변환"><span class="me-2">DataSource → DiffableDataSource로 변환.</span><a href="#datasource--diffabledatasource로-변환" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="1-기존방식"><span class="me-2">1. 기존방식.</span><a href="#1-기존방식" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><strong>Before</strong>
<a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/27efabfb-1aa3-4f1f-beea-808f0d11b00a" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/27efabfb-1aa3-4f1f-beea-808f0d11b00a" alt="CleanShot 2024-05-11 at 19 51 42@2x" loading="lazy"></a></p>

<p>UI가 Controller에 각 Section에 Item들은 몇개인지, contents를 렌더링 할때 Cell 제공하라고 요청</p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/ee8b7cc5-b1e3-4142-a3ad-c97f613e382d" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/ee8b7cc5-b1e3-4142-a3ad-c97f613e382d" alt="CleanShot 2024-05-11 at 19 54 04@2x" loading="lazy"></a></p>

<p>Controller가 Response에 관한 웹서비스 요청을 가지고 있는 경우(API)엔 조금 까다로워진다.</p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/aebc6a46-fc48-4635-a0e7-17a9afb47282" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/aebc6a46-fc48-4635-a0e7-17a9afb47282" alt="CleanShot 2024-05-11 at 19 55 17@2x" loading="lazy"></a></p>

<p>웹 서비스 응답을 통해 data의 변경사항을 알린다면, 변경사항을 반영 하기 위해 UI를 업데이트 하여 변경사항이 반영 될 수 있다.</p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/26bf6411-6aad-4b66-b72b-a9542c285a25" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/26bf6411-6aad-4b66-b72b-a9542c285a25" alt="CleanShot 2024-05-11 at 19 56 13@2x" loading="lazy"></a></p>

<p>UI 업데이트가 실패할 경우 이런 에러를 마주하게 된다.</p>

<p>이때 <code class="language-plaintext highlighter-rouge">reloadData()</code>를 호출하여 문제를 해결 할지도 모른다.</p>

<p><a href="https://noah-ios.dev/advances-in-ui-data-sources/" target="_blank">출처</a></p>

<p>기존에는 위와 같이 했는데 WWDC에서 DiffableDatasource를 소개했다.</p>

<h3 id="2-diffabledatasource-란"><span class="me-2">2. DiffableDataSource 란?</span><a href="#2-diffabledatasource-란" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>이건 TableViewDataSource</p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/ed07fc2f-c18d-499e-ad18-93f9cfce7382" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/ed07fc2f-c18d-499e-ad18-93f9cfce7382" alt="CleanShot 2024-05-11 at 19 03 21@2x" loading="lazy"></a></p>

<ul>
  <li>테이블 뷰들은 데이터의 표시만 관리하며 데이터 자체는 관리하지 않습니다. 데이터를 관리하기 위해 UITableViewDataSource 프로토콜을 구현하는 개체인 데이터 소스 개체를 테이블에 제공합니다. 데이터 소스 개체는 테이블의 데이터 관련 요청에 응답합니다. 또한 테이블의 데이터를 직접 관리하거나 앱의 다른 부분과 조정하여 데이터를 관리합니다. 데이터 소스 개체의 다른 책임은 다음과 같습니다.
    <ul>
      <li>테이블에서 섹션과 행의 수를 보고합니다.</li>
      <li>각 행의 각 행의 셀을 제공합니다.</li>
      <li>섹션 헤더 및 발명의 제목을 제공합니다.</li>
      <li>테이블 인덱스를 구성합니다.</li>
      <li>기본 데이터에 대한 변경 사항이 필요한 사용자 또는 테이블 시작 업데이트에 응답합니다.</li>
    </ul>
  </li>
</ul>

<p>(From, <a href="https://developer.apple.com/documentation/uikit/uitableviewdatasource" target="_blank">Docs</a>)
이건 TableViewDiffableDataSource</p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/0323b110-7a57-413f-97e5-76520aa776bc" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/0323b110-7a57-413f-97e5-76520aa776bc" alt="CleanShot 2024-05-11 at 19 04 29@2x" loading="lazy"></a></p>

<ul>
  <li>DiffableDatasource 개체는 테이블 뷰 개체와 함께 작동하는 특수한 유형의 데이터 소스입니다. 테이블 뷰의 데이터와 UI에 대한 업데이트를 관리하는 데 필요한 동작을 간단하고 효율적인 방법으로 제공합니다. 또한 UITableViewDataSource 프로토콜을 준수하며 프로토콜의 모든 방법에 대한 구현을 제공합니다.
    <ul>
      <li>테이블 보기에서 다양한 데이터 소스를 연결합니다.</li>
      <li>테이블 뷰의 셀 제공자를 구성합니다.</li>
      <li>데이터 현재 상태를 생성합니다.</li>
      <li>UI에서 데이터를 표시합니다.</li>
    </ul>
  </li>
</ul>

<p>(From, <a href="https://developer.apple.com/documentation/uikit/uitableviewdiffabledatasource" target="_blank">Docs</a>)</p>

<p>가장 큰 차이점이라면, 전자는 <code class="language-plaintext highlighter-rouge">protocol</code> 후자는 <code class="language-plaintext highlighter-rouge">class</code> 이다.</p>

<p>정의는 둘다 거의 같다고 볼 수 있다.</p>

<p>위에 Docs에서 가져온 내용이 있으니 한번 보는것도 좋다.</p>

<p>컬렉션뷰도 상동하므로 첨부는 하지 않는다.</p>

<p>그리고 우리는 DiffableDataSource에서 <strong>Hashable</strong>에 주목해야한다.</p>

<p>나중에 저걸 <strong>채택</strong>해야하기 때문.</p>

<h3 id="3-왜-diffabledatasource를-쓰는가"><span class="me-2">3. 왜 DiffableDatasource를 쓰는가?</span><a href="#3-왜-diffabledatasource를-쓰는가" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Hashable은 우리가 알고있는 그 <code class="language-plaintext highlighter-rouge">Hash</code>가 맞다.</p>

<blockquote>
  <p>Hash가 뭔데요? 난 처음듣는데?</p>
  <blockquote>
    <p>원본 데이터를 특정한 규칙에따라 처리하여 숫자로 만든 것
Hash값이 같다는건 두 데이터가 같다는것.</p>
    <blockquote>
      <p>Hashable을 사용함으로써 데이터의 서로 다름을 보장한다는것.</p>
    </blockquote>
  </blockquote>
</blockquote>

<p>뭐 이정도로 생각하면 되겠다.</p>

<p>다시 돌아와서 DiffableDatasource는 새로운 Snapshot 데이터 유형을 추가하여 UI 상태 관리를 크게 단순화 한다.</p>

<p>snapshot은 고유한 <strong><code class="language-plaintext highlighter-rouge">section</code></strong> 및 <strong><code class="language-plaintext highlighter-rouge">item</code></strong> 식별자를 사용하여 <code class="language-plaintext highlighter-rouge">전체 UI 상태를 캡슐화</code>한다.</p>

<p>Bold로 한게 포인트.</p>

<p>따라서 TableView, CollectionView를 업데이트 할때 먼저 새로운 Snapshot을 생성하고 현재 UI 상태로 채우고 Datasource에 적용한다.</p>

<p>장점</p>
<ol>
  <li>애니메이션
    <ul>
      <li>데이터를 추가, 업데이트, 삭제할 때마다 자동으로 데이터 변경 애니메이션이 적용된다.</li>
    </ul>
  </li>
  <li>자동 데이터 동기화
    <ul>
      <li>UI 데이터의 동기화 부분 대신 앱의 동적인 데이터와 내용에 집중할 수 있다.
-Centralized Truth를 사용하기 때문에 UI와 데이터소스간의 Truth가 맞지 않아 크래시가 발생하는 일이 없음</li>
    </ul>
  </li>
  <li>코드감소
    <ul>
      <li>전반적으로 더 적은 코드를 작성할 수 있다.</li>
    </ul>
  </li>
</ol>

<p><a href="https://velog.io/@na-young-kwon/WWDC" target="_blank">출처</a></p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/9ba5de94-dc3e-4443-ac71-88950cc4ec69" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/9ba5de94-dc3e-4443-ac71-88950cc4ec69" alt="CleanShot 2024-05-11 at 20 28 35@2x" loading="lazy"></a></p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/028f8364-acd9-4161-b622-4aba48140bc3" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/028f8364-acd9-4161-b622-4aba48140bc3" alt="CleanShot 2024-05-11 at 20 29 02@2x" loading="lazy"></a></p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/97f7efd7-1eec-49fa-b751-e6f58f486a40" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/97f7efd7-1eec-49fa-b751-e6f58f486a40" alt="CleanShot 2024-05-11 at 20 29 14@2x" loading="lazy"></a></p>

<h4 id="1-section-snapshots"><span class="me-2">1. Section Snapshots</span><a href="#1-section-snapshots" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>CollectionView와 TableView의 단일 섹션에 대한 데이터를 캡슐화 한다.</p>

<ol>
  <li>data source를 섹션크기의 덩어리로 구성 할 수 있게 한다.</li>
  <li>outline-style UI 렌더링(iOS14 전체에서 볼 수 있는 공통적인 시각적인 디자인)을 지원하는 데 필요한 계층적 데이터 모델링을 허용하기 위해</li>
</ol>

<p><a href="https://munokkim.medium.com/wwdc20-%ED%95%9C%EA%B8%80%EB%B2%88%EC%97%AD-advances-in-diffable-data-sources-2fe1f6ad8a0e" target="_blank">출처</a></p>

<h3 id="4-적용-wwdc"><span class="me-2">4. 적용 (WWDC)</span><a href="#4-적용-wwdc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/7ec5ab91-f230-4b04-bc24-b55bc3257856" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/7ec5ab91-f230-4b04-bc24-b55bc3257856" alt="CleanShot 2024-05-11 at 20 31 27@2x" loading="lazy"></a></p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/78a482fd-59f9-4a5b-b0ba-293fefc04e95" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/78a482fd-59f9-4a5b-b0ba-293fefc04e95" alt="CleanShot 2024-05-11 at 20 30 37@2x" loading="lazy"></a></p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/67e356ce-381f-4369-9955-a66ee387cde5" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/67e356ce-381f-4369-9955-a66ee387cde5" alt="CleanShot 2024-05-11 at 20 30 54@2x" loading="lazy"></a></p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/24f4c6a7-1994-4815-a340-cdff95ef5b85" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/24f4c6a7-1994-4815-a340-cdff95ef5b85" alt="CleanShot 2024-05-11 at 20 31 06@2x" loading="lazy"></a></p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/79944082-520f-49d8-bb39-99e1a4847a67" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/79944082-520f-49d8-bb39-99e1a4847a67" alt="CleanShot 2024-05-11 at 20 32 20@2x" loading="lazy"></a></p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/eca1167d-a45a-48e0-8624-b5e93e487b6b" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/eca1167d-a45a-48e0-8624-b5e93e487b6b" alt="CleanShot 2024-05-11 at 20 32 35@2x" loading="lazy"></a></p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/fdb78727-3644-40e1-acba-4e72017a8919" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/fdb78727-3644-40e1-acba-4e72017a8919" alt="CleanShot 2024-05-11 at 20 32 51@2x" loading="lazy"></a></p>

<p>WWDC의 pdf를 그대로 가져와서 옮겼는데, 이제 이걸 실제로 적용을 해보려 한다.</p>

<h3 id="5-실제-적용"><span class="me-2">5. 실제 적용.</span><a href="#5-실제-적용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>우선 우리가 적용한 모델에 Hashable 프로토콜을 채택해준다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">BookModel</span><span class="p">:</span> <span class="kt">Codable</span><span class="p">,</span> <span class="kt">Hashable</span> <span class="p">{</span> <span class="c1">// modified</span>
    
    <span class="k">var</span> <span class="nv">meta</span><span class="p">:</span> <span class="kt">Meta</span>
    <span class="k">var</span> <span class="nv">documents</span><span class="p">:</span> <span class="p">[</span><span class="kt">Document</span><span class="p">]</span>
    
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">Meta</span><span class="p">:</span> <span class="kt">Codable</span><span class="p">,</span> <span class="kt">Hashable</span> <span class="p">{</span> <span class="c1">// modified</span>
    
    <span class="k">var</span> <span class="nv">isEnd</span><span class="p">:</span> <span class="kt">Bool</span>
    <span class="k">var</span> <span class="nv">pageableCount</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">totalCount</span><span class="p">:</span> <span class="kt">Int</span>
    
    <span class="kd">enum</span> <span class="kt">CodingKeys</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">isEnd</span> <span class="o">=</span> <span class="s">"is_end"</span>
        <span class="k">case</span> <span class="n">pageableCount</span> <span class="o">=</span> <span class="s">"pageable_count"</span>
        <span class="k">case</span> <span class="n">totalCount</span> <span class="o">=</span> <span class="s">"total_count"</span>
    <span class="p">}</span>
    
    <span class="nf">init</span><span class="p">(</span><span class="nv">isEnd</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">,</span> <span class="nv">pageableCount</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span> <span class="nv">totalCount</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">isEnd</span> <span class="o">=</span> <span class="n">isEnd</span>
        <span class="k">self</span><span class="o">.</span><span class="n">pageableCount</span> <span class="o">=</span> <span class="n">pageableCount</span>
        <span class="k">self</span><span class="o">.</span><span class="n">totalCount</span> <span class="o">=</span> <span class="n">totalCount</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">Document</span><span class="p">:</span> <span class="kt">Codable</span><span class="p">,</span><span class="kt">Hashable</span> <span class="p">{</span> <span class="c1">// modified</span>
    
    <span class="k">var</span> <span class="nv">authors</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span>
    <span class="k">var</span> <span class="nv">contents</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">price</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="k">var</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">thumbnail</span><span class="p">:</span> <span class="kt">String</span>
    
    
    <span class="nf">init</span><span class="p">(</span><span class="nv">authors</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">],</span> <span class="nv">contents</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">price</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">thumbnail</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">authors</span> <span class="o">=</span> <span class="n">authors</span>
        <span class="k">self</span><span class="o">.</span><span class="n">contents</span> <span class="o">=</span> <span class="n">contents</span>
        <span class="k">self</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="n">price</span>
        <span class="k">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">self</span><span class="o">.</span><span class="n">thumbnail</span> <span class="o">=</span> <span class="n">thumbnail</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></div></div>

<p>DiffableModel이라는 파일을 하나 만들어주고</p>

<p>그 다음 섹션과, 섹션의 아이템을 열거형으로 만들어 준다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="kd">enum</span> <span class="kt">DiffableSectionModel</span> <span class="p">{</span>
    
    <span class="k">case</span> <span class="n">recent</span>
    <span class="k">case</span> <span class="n">search</span>
    
<span class="p">}</span>

<span class="kd">enum</span> <span class="kt">DiffableSectionItemModel</span><span class="p">:</span> <span class="kt">Hashable</span> <span class="p">{</span>
    
    <span class="k">case</span> <span class="nf">recent</span><span class="p">(</span><span class="kt">RecentModel</span><span class="p">)</span>
    <span class="k">case</span> <span class="nf">search</span><span class="p">(</span><span class="kt">Document</span><span class="p">)</span>
    
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>이때 ItemModel에는, 이전에 TableView와 CollectionView에서 사용하던 item Type을 가져왔다.</p>

<p>이때 ItemModel에는 반드시 <strong>Hashable</strong>을 해준다.</p>

<p>이제 DiffableDatasource 를 만든다.</p>

<p>Diffable Extension을 하나 만들어 주었다.</p>

<p>거기에 적용을 해볼 예정.</p>

<p>Datasource를 만들때 UIkit을 import를 할수밖에 없는 상황이 발생하므로 VM에서 변경한다.</p>

<p>이제 DiffableDatasource 객체를 하나 만들어준다.</p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/f5fb6feb-9293-4118-8c2a-bb75534f1182" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/f5fb6feb-9293-4118-8c2a-bb75534f1182" alt="CleanShot 2024-05-11 at 21 44 56@2x" loading="lazy"></a></p>

<p>extension에서는 불가하므로 이녀석만 mainVC로 이동</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>    <span class="k">var</span> <span class="nv">tableDatasource</span><span class="p">:</span> <span class="kt">UITableViewDiffableDataSource</span><span class="o">&lt;</span><span class="kt">DiffableSectionModel</span><span class="p">,</span> <span class="kt">DiffableSectionItemModel</span><span class="o">&gt;</span><span class="p">?</span>
    <span class="k">var</span> <span class="nv">collectinDatasource</span><span class="p">:</span> <span class="kt">UICollectionViewDiffableDataSource</span><span class="o">&lt;</span><span class="kt">DiffableSectionModel</span><span class="p">,</span> <span class="kt">DiffableSectionItemModel</span><span class="o">&gt;</span><span class="p">?</span>
</pre></td></tr></tbody></table></code></div></div>
<p>미리 둘다 만들어 준다</p>

<p>옵셔널인 이유는 ? 를 안하면 <code class="language-plaintext highlighter-rouge">Initializing이 필요</code>하기 때문</p>

<p>extension으로 가서 함수를 하나 만들어 준다.</p>

<h4 id="1-tableview"><span class="me-2">1. TableView</span><a href="#1-tableview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre> <span class="kd">func</span> <span class="nf">configureDiffableDataSource</span> <span class="p">()</span> <span class="p">{</span>
        <span class="n">tableDatasource</span> <span class="o">=</span> <span class="kt">UITableViewDiffableDataSource</span><span class="p">(</span><span class="nv">tableView</span><span class="p">:</span> <span class="n">resultView</span><span class="o">.</span><span class="n">tableView</span><span class="p">,</span> <span class="nv">cellProvider</span><span class="p">:</span> <span class="p">{</span> <span class="n">tableView</span><span class="p">,</span> <span class="n">indexPath</span><span class="p">,</span> <span class="n">itemIdentifier</span> <span class="k">in</span>
            
            <span class="k">switch</span> <span class="n">itemIdentifier</span> <span class="p">{</span>
            <span class="k">case</span> <span class="o">.</span><span class="nf">search</span><span class="p">(</span><span class="k">let</span> <span class="nv">document</span><span class="p">):</span>
                <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="kt">Constants</span><span class="o">.</span><span class="n">tableViewCellIdentifier</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">)</span> <span class="k">as!</span> <span class="kt">ResultTableViewCell</span>
                
                <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="n">document</span><span class="p">)</span>
                
                <span class="k">return</span> <span class="n">cell</span>
            <span class="k">case</span> <span class="o">.</span><span class="nf">recent</span><span class="p">(</span><span class="n">_</span><span class="p">):</span> <span class="c1">// recent는 CollectionView에 사용할것</span>
                <span class="k">return</span> <span class="kt">UITableViewCell</span><span class="p">()</span>
            <span class="p">}</span>
            
        <span class="p">})</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>item에 search, recent 두개를 한번에 해두어서</p>

<p>recent일 때는 그냥 UItableviewcell을 리턴하게 했다.</p>

<p>그다음엔 snapshot을 적용할 함수를 만들어 준다.</p>

<p>함수를 만들다가 내방식과 튜터님의 방식이 적용이 안된다는걸 파악했고, 다시 고친다.</p>

<p>우선 sectionitemModel을 지웠다.</p>

<p>그리고</p>

<p><code class="language-plaintext highlighter-rouge">var tableDatasource: UITableViewDiffableDataSource&lt;DiffableSectionModel, Document&gt;?</code> datasource도 item을 그냥 document로 반환시킨다.</p>

<p>그리고 diffable에 적용할 함수를 구현한다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">configureDiffableDataSource</span> <span class="p">()</span> <span class="p">{</span>
        <span class="n">tableDatasource</span> <span class="o">=</span> <span class="kt">UITableViewDiffableDataSource</span><span class="p">(</span><span class="nv">tableView</span><span class="p">:</span> <span class="n">resultView</span><span class="o">.</span><span class="n">tableView</span><span class="p">,</span> <span class="nv">cellProvider</span><span class="p">:</span> <span class="p">{</span> <span class="n">tableView</span><span class="p">,</span> <span class="n">indexPath</span><span class="p">,</span> <span class="n">itemIdentifier</span> <span class="k">in</span>
            
            <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="kt">Constants</span><span class="o">.</span><span class="n">tableViewCellIdentifier</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">)</span> <span class="k">as!</span> <span class="kt">ResultTableViewCell</span>
            
            <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="n">itemIdentifier</span><span class="p">)</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">selectionStyle</span> <span class="o">=</span> <span class="o">.</span><span class="k">none</span>
            
            <span class="k">return</span> <span class="n">cell</span>
        <span class="p">})</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">configureSnapshot</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nv">snapshot</span> <span class="o">=</span> <span class="kt">NSDiffableDataSourceSnapshot</span><span class="o">&lt;</span><span class="kt">DiffableSectionModel</span><span class="p">,</span> <span class="kt">Document</span><span class="o">&gt;</span><span class="p">()</span>
        <span class="n">snapshot</span><span class="o">.</span><span class="nf">appendSections</span><span class="p">([</span><span class="o">.</span><span class="n">search</span><span class="p">])</span>
        <span class="n">snapshot</span><span class="o">.</span><span class="nf">appendItems</span><span class="p">(</span><span class="n">searchVM</span><span class="o">.</span><span class="n">document</span><span class="p">)</span>
        
        <span class="n">tableDatasource</span><span class="p">?</span><span class="o">.</span><span class="nf">apply</span><span class="p">(</span><span class="n">snapshot</span><span class="p">)</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>그 후, VC의 bind에서</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">searchVM</span><span class="o">.</span><span class="n">$document</span>
            <span class="o">.</span><span class="nf">receive</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
            <span class="o">.</span><span class="n">sink</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">_</span> <span class="k">in</span>
                <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="nf">configureSnapshot</span><span class="p">()</span> <span class="c1">// modified</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">cancellables</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>reloaddata에서 이렇게 스냅샷 적용으로 바꿔준다.</p>

<p>작동 완료.</p>

<p>이제 tableview의 <code class="language-plaintext highlighter-rouge">cellForRowAt</code>, <code class="language-plaintext highlighter-rouge">numberOfRowsInSection</code>은 필요가 없어졌다.</p>

<p>하지만 무한스크롤은 필요해서 그부분만 제외하고 나머지는 살려둔다.</p>

<p>wishlistVC도 상동</p>

<h4 id="2-collectionview"><span class="me-2">2. CollectionView</span><a href="#2-collectionview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>이것도 역시 <code class="language-plaintext highlighter-rouge">var collectionDatasource: UICollectionViewDiffableDataSource&lt;DiffableSectionModel, RecentModel&gt;?</code> 이렇게 실제 사용한 모델로만 해준다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">configureDiffableDataSource</span> <span class="p">()</span> <span class="p">{</span>
        <span class="n">tableDatasource</span> <span class="o">=</span> <span class="kt">UITableViewDiffableDataSource</span><span class="p">(</span><span class="nv">tableView</span><span class="p">:</span> <span class="n">resultView</span><span class="o">.</span><span class="n">tableView</span><span class="p">,</span> <span class="nv">cellProvider</span><span class="p">:</span> <span class="p">{</span> <span class="n">tableView</span><span class="p">,</span> <span class="n">indexPath</span><span class="p">,</span> <span class="n">itemIdentifier</span> <span class="k">in</span>
            
            <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="kt">Constants</span><span class="o">.</span><span class="n">tableViewCellIdentifier</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">)</span> <span class="k">as!</span> <span class="kt">ResultTableViewCell</span>
            
            <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="n">itemIdentifier</span><span class="p">)</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">selectionStyle</span> <span class="o">=</span> <span class="o">.</span><span class="k">none</span>
            
            <span class="k">return</span> <span class="n">cell</span>
        <span class="p">})</span>
        
        <span class="c1">// added</span>
        <span class="n">collectionDatasource</span> <span class="o">=</span> <span class="kt">UICollectionViewDiffableDataSource</span><span class="p">(</span><span class="nv">collectionView</span><span class="p">:</span> <span class="n">recentView</span><span class="o">.</span><span class="n">collectionView</span><span class="p">,</span> <span class="nv">cellProvider</span><span class="p">:</span> <span class="p">{</span> <span class="n">collectionView</span><span class="p">,</span> <span class="n">indexPath</span><span class="p">,</span> <span class="n">itemIdentifier</span> <span class="k">in</span>
            
            <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">collectionView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withReuseIdentifier</span><span class="p">:</span> <span class="kt">Constants</span><span class="o">.</span><span class="n">collectionViewCellIdentifier</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="n">indexPath</span><span class="p">)</span> <span class="k">as!</span> <span class="kt">RecentCollectionViewCell</span>
            
            <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="n">itemIdentifier</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="n">cell</span>
        <span class="p">})</span>
        
    <span class="p">}</span>
    
<span class="kd">func</span> <span class="nf">collectionConfigureSnapshot</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nv">collectionSnapshot</span> <span class="o">=</span> <span class="kt">NSDiffableDataSourceSnapshot</span><span class="o">&lt;</span><span class="kt">DiffableSectionModel</span><span class="p">,</span> <span class="kt">RecentModel</span><span class="o">&gt;</span><span class="p">()</span>
        <span class="n">collectionSnapshot</span><span class="o">.</span><span class="nf">appendSections</span><span class="p">([</span><span class="o">.</span><span class="n">recent</span><span class="p">])</span>
        <span class="n">collectionSnapshot</span><span class="o">.</span><span class="nf">appendItems</span><span class="p">(</span><span class="n">recentVM</span><span class="o">.</span><span class="n">recentDocument</span><span class="p">)</span>
        
        <span class="n">collectionDatasource</span><span class="p">?</span><span class="o">.</span><span class="nf">apply</span><span class="p">(</span><span class="n">collectionSnapshot</span><span class="p">,</span> <span class="nv">animatingDifferences</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>Fatal: supplied item identifiers are not unique. Duplicate identifiers
</pre></td></tr></tbody></table></code></div></div>

<p>문제가 발생</p>

<p>이건 나중에 다시 해결해야할듯 하다.</p>

<h2 id="피드백-보완"><span class="me-2">피드백 보완</span><a href="#피드백-보완" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="service-group-생성"><span class="me-2">Service Group 생성</span><a href="#service-group-생성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>DiffableDatasource를 검색하다 보니 VM에는 UIKit도 import할 이유가 없다고 한다.</p>

<p>생각해보니, 그게 맞는말이다 UIKit는 View와 관련이 있는데, 이걸 할 필요가 없었다. 근데 지금 RecentVM이나 WishVM의 경우 Coredata를 쓰기위해 Context를 만들다보니 자연스럽게 import UIKit를 하고있다.</p>

<p>그래서 이부분도 고려하셔서 피드백을 주신게 아닌가? 라는 생각이 든다.</p>

<p>특히 network의 경우는 처음에 나누었다가 나중에, VM으로 넣어버렸는데, 아직도 공부가 더 필요하다는 생각이 든다.</p>

<h4 id="1-networkmanager-이관"><span class="me-2">1. NetworkManager 이관</span><a href="#1-networkmanager-이관" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="kt">NetworkManager</span> <span class="p">{</span>
    
    <span class="kd">static</span> <span class="k">let</span> <span class="nv">shared</span> <span class="o">=</span> <span class="kt">NetworkManager</span><span class="p">()</span>
    
    <span class="kd">private</span> <span class="nf">init</span> <span class="p">()</span> <span class="p">{}</span>
    
    <span class="k">let</span> <span class="nv">searchVM</span> <span class="o">=</span> <span class="kt">SearchVM</span><span class="p">()</span>
    
    <span class="kd">func</span> <span class="nf">fetchTotalRequest</span><span class="p">(</span><span class="nv">queryValue</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">page</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span> <span class="nv">cancellables</span><span class="p">:</span> <span class="kt">Set</span><span class="o">&lt;</span><span class="kt">AnyCancellable</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="k">let</span> <span class="nv">urlString</span> <span class="o">=</span> <span class="s">"https://dapi.kakao.com/v3/search/book?target=title"</span>
        <span class="k">let</span> <span class="nv">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Authorization"</span> <span class="p">:</span> <span class="s">"KakaoAK </span><span class="se">\(</span><span class="kt">Secret</span><span class="o">.</span><span class="n">apikey</span><span class="se">)</span><span class="s">"</span><span class="p">]</span>
        
        <span class="k">var</span> <span class="nv">urlComponent</span> <span class="o">=</span> <span class="kt">URLComponents</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="n">urlString</span><span class="p">)</span>
        <span class="n">urlComponent</span><span class="p">?</span><span class="o">.</span><span class="n">queryItems</span><span class="p">?</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="kt">URLQueryItem</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"query"</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="n">queryValue</span><span class="p">))</span>
        <span class="n">urlComponent</span><span class="p">?</span><span class="o">.</span><span class="n">queryItems</span><span class="p">?</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="kt">URLQueryItem</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"page"</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="n">page</span><span class="o">.</span><span class="n">stringValue</span><span class="p">))</span>
        
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">url</span> <span class="o">=</span> <span class="n">urlComponent</span><span class="p">?</span><span class="o">.</span><span class="n">url</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        
        <span class="k">var</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">URLRequest</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span>
        <span class="n">request</span><span class="o">.</span><span class="n">allHTTPHeaderFields</span> <span class="o">=</span> <span class="n">headers</span>
        <span class="n">request</span><span class="o">.</span><span class="n">httpMethod</span> <span class="o">=</span> <span class="s">"GET"</span>
        
        <span class="k">let</span> <span class="nv">session</span> <span class="o">=</span> <span class="kt">URLSession</span><span class="p">(</span><span class="nv">configuration</span><span class="p">:</span> <span class="o">.</span><span class="k">default</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="nf">dataTaskPublisher</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="n">request</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">map</span><span class="p">(\</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="kt">BookModel</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">JSONDecoder</span><span class="p">())</span>
            <span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">model</span> <span class="k">in</span>
                <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">isEnd</span> <span class="o">==</span> <span class="kc">false</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">documents</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="p">[]</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">replaceError</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="p">[])</span>
            <span class="o">.</span><span class="nf">assign</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="p">\</span><span class="o">.</span><span class="n">document</span><span class="p">,</span> <span class="nv">on</span><span class="p">:</span> <span class="n">searchVM</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">searchVM</span><span class="o">.</span><span class="n">cancellables</span><span class="p">)</span>
    <span class="p">}</span>
    
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>다음과 같이 만들어 준다.</p>

<p>하지만 문제는 검색결과 값이 넘어가지 않는 상태이다.</p>

<p><a href="https://www.youtube.com/watch?v=2ORJcQgP4a0&amp;t=330s" target="_blank">YouTube</a>를 보고 내용을 좀 수정해야할 필요성을 느낀다.</p>

<p>문득 이부분을 Completion Handler를 통해서 전달을 해볼까 했는데, 위와같은 방법이 있어서 적용을 해보려한다.</p>

<p>안그래도 <code class="language-plaintext highlighter-rouge">Future</code> 써보고 싶었는데 잘되었다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="kt">NetworkManager</span> <span class="p">{</span>
    
    <span class="kd">static</span> <span class="k">let</span> <span class="nv">shared</span> <span class="o">=</span> <span class="kt">NetworkManager</span><span class="p">()</span>
    
    <span class="kd">private</span> <span class="nf">init</span> <span class="p">()</span> <span class="p">{}</span>
    
    <span class="k">let</span> <span class="nv">searchVM</span> <span class="o">=</span> <span class="kt">SearchVM</span><span class="p">()</span>
    
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">cancellables</span> <span class="o">=</span> <span class="kt">Set</span><span class="o">&lt;</span><span class="kt">AnyCancellable</span><span class="o">&gt;</span><span class="p">()</span>
    
    <span class="kd">func</span> <span class="nf">fetchTotalRequest</span><span class="p">(</span><span class="nv">queryValue</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">page</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Future</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">Document</span><span class="p">],</span> <span class="kt">Error</span><span class="o">&gt;</span> <span class="p">{</span>
        
        <span class="k">return</span> <span class="kt">Future</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">Document</span><span class="p">],</span> <span class="kt">Error</span><span class="o">&gt;</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">complete</span> <span class="k">in</span>
            
            <span class="k">let</span> <span class="nv">urlString</span> <span class="o">=</span> <span class="s">"https://dapi.kakao.com/v3/search/book?target=title"</span>
            <span class="k">let</span> <span class="nv">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Authorization"</span> <span class="p">:</span> <span class="s">"KakaoAK </span><span class="se">\(</span><span class="kt">Secret</span><span class="o">.</span><span class="n">apikey</span><span class="se">)</span><span class="s">"</span><span class="p">]</span>
            
            <span class="k">var</span> <span class="nv">urlComponent</span> <span class="o">=</span> <span class="kt">URLComponents</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="n">urlString</span><span class="p">)</span>
            <span class="n">urlComponent</span><span class="p">?</span><span class="o">.</span><span class="n">queryItems</span><span class="p">?</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="kt">URLQueryItem</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"query"</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="n">queryValue</span><span class="p">))</span>
            <span class="n">urlComponent</span><span class="p">?</span><span class="o">.</span><span class="n">queryItems</span><span class="p">?</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="kt">URLQueryItem</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"page"</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="n">page</span><span class="o">.</span><span class="n">stringValue</span><span class="p">))</span>
            
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">url</span> <span class="o">=</span> <span class="n">urlComponent</span><span class="p">?</span><span class="o">.</span><span class="n">url</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span>
            <span class="p">}</span>
            
            <span class="k">var</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">URLRequest</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span>
            <span class="n">request</span><span class="o">.</span><span class="n">allHTTPHeaderFields</span> <span class="o">=</span> <span class="n">headers</span>
            <span class="n">request</span><span class="o">.</span><span class="n">httpMethod</span> <span class="o">=</span> <span class="s">"GET"</span>
            
            <span class="k">let</span> <span class="nv">session</span> <span class="o">=</span> <span class="kt">URLSession</span><span class="p">(</span><span class="nv">configuration</span><span class="p">:</span> <span class="o">.</span><span class="k">default</span><span class="p">)</span>
            <span class="n">session</span><span class="o">.</span><span class="nf">dataTaskPublisher</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="n">request</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">map</span><span class="p">(\</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="kt">BookModel</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">JSONDecoder</span><span class="p">())</span>
                <span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span>
                <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">model</span> <span class="k">in</span>
                    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">isEnd</span> <span class="o">==</span> <span class="kc">false</span> <span class="p">{</span>
                        <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">documents</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="k">return</span> <span class="p">[]</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="o">.</span><span class="nf">replaceError</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="p">[])</span>
                <span class="o">.</span><span class="nf">sink</span><span class="p">(</span><span class="nv">receiveValue</span><span class="p">:</span> <span class="p">{</span> <span class="n">document</span> <span class="k">in</span>
                    <span class="nf">complete</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">document</span><span class="p">))</span>
                <span class="p">})</span>
                <span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">self</span><span class="o">!.</span><span class="n">cancellables</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>    
<span class="p">}</span>

</pre></td></tr></tbody></table></code></div></div>

<p>우선 다음과 같이 코드를 수정하고.</p>

<p>VM에서도 다음과 같이 수정했다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre> <span class="kd">func</span> <span class="nf">transform</span><span class="p">(</span><span class="nv">input</span><span class="p">:</span> <span class="kt">Input</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="kt">Publishers</span><span class="o">.</span><span class="kt">CombineLatest</span><span class="p">(</span><span class="n">input</span><span class="o">.</span><span class="n">searchPublisher</span><span class="p">,</span> <span class="n">input</span><span class="o">.</span><span class="n">numberPublisher</span><span class="p">)</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="k">self</span><span class="p">]</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">page</span><span class="p">)</span> <span class="k">in</span>
                <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
                    <span class="n">currentPage</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">document</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="p">}</span>
                <span class="nf">return</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">currentPage</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span>
            <span class="o">.</span><span class="nf">print</span><span class="p">()</span>
            <span class="o">.</span><span class="n">sink</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">page</span><span class="p">)</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="o">!</span><span class="n">value</span><span class="o">.</span><span class="n">isEmpty</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span> <span class="c1">// value가 빈 문자열인 경우 fetchTotalRequest 호출하지 않음</span>
                <span class="kt">NetworkManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">fetchTotalRequest</span><span class="p">(</span><span class="nv">queryValue</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span> <span class="nv">page</span><span class="p">:</span> <span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">sink</span> <span class="p">{</span> <span class="n">completion</span> <span class="k">in</span>
                    <span class="k">switch</span> <span class="n">completion</span> <span class="p">{</span>
                    <span class="k">case</span> <span class="o">.</span><span class="nv">finished</span><span class="p">:</span>
                        <span class="nf">print</span><span class="p">(</span><span class="s">"success"</span><span class="p">)</span>
                    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
                        <span class="nf">print</span><span class="p">(</span><span class="s">"erorr is </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="nv">receiveValue</span><span class="p">:</span> <span class="p">{</span> <span class="n">document</span> <span class="k">in</span>
                    <span class="k">self</span><span class="o">!.</span><span class="n">document</span> <span class="o">=</span> <span class="n">document</span>
                <span class="p">}</span><span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">self</span><span class="o">!.</span><span class="n">cancellables</span><span class="p">)</span>

            <span class="p">}</span>
            <span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">cancellables</span><span class="p">)</span>
        
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>우선 출력은 되나, document에 바꿔치기가 되므로 해당 부분을 append하게 해줘야한다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre> <span class="kd">func</span> <span class="nf">transform</span><span class="p">(</span><span class="nv">input</span><span class="p">:</span> <span class="kt">Input</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="kt">Publishers</span><span class="o">.</span><span class="kt">CombineLatest</span><span class="p">(</span><span class="n">input</span><span class="o">.</span><span class="n">searchPublisher</span><span class="p">,</span> <span class="n">input</span><span class="o">.</span><span class="n">numberPublisher</span><span class="p">)</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="k">self</span><span class="p">]</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">page</span><span class="p">)</span> <span class="k">in</span>
                <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
                    <span class="n">currentPage</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">document</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="p">}</span>
                <span class="nf">return</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">currentPage</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span>
            <span class="o">.</span><span class="nf">print</span><span class="p">()</span>
            <span class="o">.</span><span class="n">sink</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">page</span><span class="p">)</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="o">!</span><span class="n">value</span><span class="o">.</span><span class="n">isEmpty</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span> <span class="c1">// value가 빈 문자열인 경우 fetchTotalRequest 호출하지 않음</span>
                <span class="kt">NetworkManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">fetchTotalRequest</span><span class="p">(</span><span class="nv">queryValue</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span> <span class="nv">page</span><span class="p">:</span> <span class="n">page</span><span class="p">)</span><span class="o">.</span><span class="n">sink</span> <span class="p">{</span> <span class="n">completion</span> <span class="k">in</span>
                    <span class="k">switch</span> <span class="n">completion</span> <span class="p">{</span>
                    <span class="k">case</span> <span class="o">.</span><span class="nv">finished</span><span class="p">:</span>
                        <span class="nf">print</span><span class="p">(</span><span class="s">"success"</span><span class="p">)</span>
                    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
                        <span class="nf">print</span><span class="p">(</span><span class="s">"erorr is </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="nv">receiveValue</span><span class="p">:</span> <span class="p">{</span> <span class="n">document</span> <span class="k">in</span>
                    <span class="n">document</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="n">doc</span> <span class="k">in</span>
                        <span class="k">self</span><span class="o">!.</span><span class="n">document</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">}</span><span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">self</span><span class="o">!.</span><span class="n">cancellables</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">cancellables</span><span class="p">)</span>
        
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>receiveValue에 다음과 같이 결과를 하나씩 append하게 바꿔주었다.</p>

<p>작동 확인 완료.</p>

<h4 id="2-coredatamanager-이관"><span class="me-2">2. CoreDataManager 이관</span><a href="#2-coredatamanager-이관" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>이건 Recent / Wish VM 에 해당하는 부분을 옮기면 될 것 같다.</p>

<p>이것도 역시 그냥 singleton pattern을 사용해서 할 예정</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">saveWishDocumentToCoredata</span> <span class="p">(</span><span class="nv">data</span><span class="p">:</span> <span class="kt">Document</span><span class="p">)</span> <span class="p">{</span>
        
        <span class="k">let</span> <span class="nv">newItem</span> <span class="o">=</span> <span class="kt">WishListModel</span><span class="p">(</span><span class="nv">context</span><span class="p">:</span> <span class="n">context</span><span class="p">)</span>
        <span class="n">newItem</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">title</span>
        <span class="n">newItem</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">authors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">newItem</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">contents</span>
        <span class="n">newItem</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">thumbnail</span>
        <span class="n">newItem</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="kt">Int64</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">price</span><span class="p">)</span>
        
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">context</span><span class="o">.</span><span class="nf">save</span><span class="p">()</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"담기 완료"</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
            <span class="n">routerSubject</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="kt">Router</span><span class="o">.</span><span class="nf">alert</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"예외 발생"</span><span class="p">,</span> <span class="nv">message</span><span class="p">:</span> <span class="s">"</span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s"> 이 발생했습니다."</span><span class="p">))</span>
        <span class="p">}</span>
        
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">getWishDocumentfromCoreData</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Future</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">WishListModel</span><span class="p">]</span> <span class="p">,</span><span class="kt">Error</span><span class="o">&gt;</span><span class="p">{</span>
        
        <span class="k">return</span> <span class="kt">Future</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">WishListModel</span><span class="p">],</span> <span class="kt">Error</span><span class="o">&gt;</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="k">self</span><span class="p">]</span> <span class="n">complete</span> <span class="k">in</span>
            <span class="k">do</span> <span class="p">{</span>
                <span class="k">try</span> <span class="n">context</span><span class="o">.</span><span class="nf">fetch</span><span class="p">(</span><span class="n">wishRequest</span><span class="p">)</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">data</span> <span class="k">in</span>
                    <span class="kt">Publishers</span><span class="o">.</span><span class="kt">Sequence</span><span class="p">(</span><span class="nv">sequence</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="p">])</span>
                <span class="p">}</span>
                <span class="o">.</span><span class="nf">collect</span><span class="p">()</span>
                <span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span>
                <span class="o">.</span><span class="nf">sink</span><span class="p">(</span><span class="nv">receiveValue</span><span class="p">:</span> <span class="p">{</span> <span class="n">model</span> <span class="k">in</span>
                    <span class="nf">complete</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
                <span class="p">})</span>
                <span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">cancellables</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
                <span class="n">routerSubject</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="kt">Router</span><span class="o">.</span><span class="nf">alert</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"예외 발생"</span><span class="p">,</span> <span class="nv">message</span><span class="p">:</span> <span class="s">"</span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s"> 이 발생했습니다."</span><span class="p">))</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">getSpecificData</span> <span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Future</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">WishListModel</span><span class="p">]</span> <span class="p">,</span><span class="kt">Error</span><span class="o">&gt;</span> <span class="p">{</span>
        
        <span class="k">return</span> <span class="kt">Future</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">WishListModel</span><span class="p">],</span> <span class="kt">Error</span><span class="o">&gt;</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="k">self</span><span class="p">]</span> <span class="n">complete</span> <span class="k">in</span>
            
            <span class="k">let</span> <span class="nv">predicateRequest</span><span class="p">:</span> <span class="kt">NSFetchRequest</span><span class="o">&lt;</span><span class="kt">WishListModel</span><span class="o">&gt;</span> <span class="o">=</span> <span class="kt">WishListModel</span><span class="o">.</span><span class="nf">fetchRequest</span><span class="p">()</span>
            <span class="k">let</span> <span class="nv">predicate</span> <span class="o">=</span> <span class="kt">NSPredicate</span><span class="p">(</span><span class="nv">format</span><span class="p">:</span> <span class="s">"title == %@"</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
            <span class="n">predicateRequest</span><span class="o">.</span><span class="n">predicate</span> <span class="o">=</span> <span class="n">predicate</span>
            
            <span class="k">do</span> <span class="p">{</span>
                <span class="k">try</span> <span class="n">context</span><span class="o">.</span><span class="nf">fetch</span><span class="p">(</span><span class="n">predicateRequest</span><span class="p">)</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">data</span> <span class="k">in</span>
                    <span class="kt">Publishers</span><span class="o">.</span><span class="kt">Sequence</span><span class="p">(</span><span class="nv">sequence</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="p">])</span>
                <span class="p">}</span>
                <span class="o">.</span><span class="nf">collect</span><span class="p">()</span>
                <span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span>
                <span class="o">.</span><span class="nf">sink</span><span class="p">(</span><span class="nv">receiveValue</span><span class="p">:</span> <span class="p">{</span> <span class="n">model</span> <span class="k">in</span>
                    <span class="nf">complete</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
                <span class="p">})</span>
                <span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">cancellables</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
                <span class="n">routerSubject</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="kt">Router</span><span class="o">.</span><span class="nf">alert</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"예외 발생"</span><span class="p">,</span> <span class="nv">message</span><span class="p">:</span> <span class="s">"</span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s"> 이 발생했습니다."</span><span class="p">))</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">deleteAllData</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">fetchRequest</span><span class="p">:</span> <span class="kt">NSFetchRequest</span><span class="o">&lt;</span><span class="kt">NSFetchRequestResult</span><span class="o">&gt;</span> <span class="o">=</span> <span class="kt">NSFetchRequest</span><span class="p">(</span><span class="nv">entityName</span><span class="p">:</span> <span class="s">"WishListModel"</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">deleteRequest</span> <span class="o">=</span> <span class="kt">NSBatchDeleteRequest</span><span class="p">(</span><span class="nv">fetchRequest</span><span class="p">:</span> <span class="n">fetchRequest</span><span class="p">)</span>
        
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">context</span><span class="o">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">deleteRequest</span><span class="p">)</span>
            <span class="k">try</span> <span class="n">context</span><span class="o">.</span><span class="nf">save</span><span class="p">()</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
            <span class="n">routerSubject</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="kt">Router</span><span class="o">.</span><span class="nf">alert</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"예외 발생"</span><span class="p">,</span> <span class="nv">message</span><span class="p">:</span> <span class="s">"</span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s"> 이 발생했습니다."</span><span class="p">))</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">deleteSpeificData</span> <span class="p">(</span><span class="nv">selectedCell</span><span class="p">:</span> <span class="kt">NSManagedObject</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="k">try</span> <span class="n">context</span><span class="o">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">selectedCell</span><span class="p">)</span>
            <span class="k">try</span> <span class="n">context</span><span class="o">.</span><span class="nf">save</span><span class="p">()</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
            <span class="n">routerSubject</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="kt">Router</span><span class="o">.</span><span class="nf">alert</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"예외 발생"</span><span class="p">,</span> <span class="nv">message</span><span class="p">:</span> <span class="s">"</span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s"> 이 발생했습니다."</span><span class="p">))</span>
        <span class="p">}</span>
        
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>다음과 같이 코드를 모두 이관시켜준다</p>

<p>특징이라면 network와 같이 배열에 저장해야하는경우엔 Future를 사용하여 리턴시켰다.</p>

<p>VM도 다음과 같이 정리</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">checkDuplicate</span> <span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
        
        <span class="k">var</span> <span class="nv">flag</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="nf">getSpecificDocument</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="n">title</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">wishDocument</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">flag</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">getWholeDocument</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kt">CoredataManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">getWishDocumentfromCoreData</span><span class="p">()</span><span class="o">.</span><span class="n">sink</span> <span class="p">{</span> <span class="n">complete</span> <span class="k">in</span>
            <span class="k">switch</span> <span class="n">complete</span> <span class="p">{</span>
            <span class="k">case</span> <span class="o">.</span><span class="nv">finished</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="nv">receiveValue</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">model</span> <span class="k">in</span>
            <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">wishDocument</span> <span class="o">=</span> <span class="n">model</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">cancellables</span><span class="p">)</span>

    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">getSpecificDocument</span> <span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">CoredataManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">getSpecificData</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="n">title</span><span class="p">)</span><span class="o">.</span><span class="n">sink</span> <span class="p">{</span> <span class="n">complete</span> <span class="k">in</span>
            <span class="k">switch</span> <span class="n">complete</span> <span class="p">{</span>
            <span class="k">case</span> <span class="o">.</span><span class="nv">finished</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="nv">receiveValue</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">model</span> <span class="k">in</span>
            <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">wishDocument</span> <span class="o">=</span> <span class="n">model</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">cancellables</span><span class="p">)</span>

    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">deleteSelectedData</span><span class="p">(</span><span class="nv">selectedCell</span><span class="p">:</span> <span class="kt">NSManagedObject</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">CoredataManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">deleteSpeificData</span><span class="p">(</span><span class="nv">selectedCell</span><span class="p">:</span> <span class="n">selectedCell</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">removeAllData</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kt">CoredataManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">deleteAllData</span><span class="p">()</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>생각해보니 coredata에 저장하는것도 vm에서 해도 될것같아서 이렇게 적는다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">saveDataToRecent</span> <span class="p">(</span><span class="nv">data</span><span class="p">:</span> <span class="kt">Document</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">CoredataManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">saveRecentDocumentToCoredata</span><span class="p">(</span><span class="nv">data</span><span class="p">:</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>paramter가 꼬리에 꼬리를 물어도 어차피 같은 타입이므로 괜찮기 때문.</p>

<p>완료.</p>

<p>예외처리만 하면 될듯하다.</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/%EC%BA%A0%ED%94%84/">캠프</a>,
          <a href="/categories/10%EC%A3%BC%EC%B0%A8/">10주차</a>
      </div>
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          이 기사는 저작권자의 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         라이센스를 따릅니다.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">공유하기</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=10%EC%A3%BC%EC%B0%A8%20%EA%B3%BC%EC%A0%9C%20(10)%20-%20Harold%60s%20DLog&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F10%25EC%25A3%25BC%25EC%25B0%25A8-%25EA%25B3%25BC%25EC%25A0%259C-%2810%29%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=10%EC%A3%BC%EC%B0%A8%20%EA%B3%BC%EC%A0%9C%20(10)%20-%20Harold%60s%20DLog&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F10%25EC%25A3%25BC%25EC%25B0%25A8-%25EA%25B3%25BC%25EC%25A0%259C-%2810%29%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2F10%25EC%25A3%25BC%25EC%25B0%25A8-%25EA%25B3%25BC%25EC%25A0%259C-%2810%29%2F&text=10%EC%A3%BC%EC%B0%A8%20%EA%B3%BC%EC%A0%9C%20(10)%20-%20Harold%60s%20DLog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="링크 복사하기"
      data-title-succeed="링크가 복사되었습니다!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
<script src="https://utteranc.es/client.js"
  repo="haroldfromk/haroldfromk.github.io"
  issue-term="pathname"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script>

</article>



            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">최근 업데이트</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/ObjectTest/">CartAppTest</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/(Deep-Dive)-Object/">(Deep Dive) @ObservedObject vs @StateObject</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/TourApp_6/">TourApp (6)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/TourApp_5/">TourApp (5)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/TourApp_4/">TourApp (4)</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">인기 태그</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%BD%94%EB%94%A9%ED%85%8C%EC%8A%A4%ED%8A%B8/">코딩테스트</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EB%B3%B4%EB%A5%98%EC%A4%91/">보류중</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/swiftui/">SwiftUI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/myself/">Myself</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EB%B3%B4%EB%A5%98%ED%96%88%EB%8D%98%EB%AC%B8%EC%A0%9C/">보류했던문제</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EA%B3%BC%EC%A0%9C/">과제</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/networking/">Networking</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%95%BC%EA%B5%AC/">야구</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/git/">Git</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">바로가기</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">관련된 글</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/10%EC%A3%BC%EC%B0%A8-%EA%B3%BC%EC%A0%9C-(1)/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1714831200"
  data-df="YYYY/MM/DD"
  
>
  2024/05/04
</time>

              <h4 class="pt-0 my-2">10주차 과제 (1)</h4>
              <div class="text-muted">
                <p>
                  





                  이번에도 과제가 주어졌다.

사실 MVC로하면 길어야 이틀짜리 과제인데, 이번엔 좀 새로운 시도를 해보고자 컴바인을 공부를 하면서 mvvm도 약간 공부를 했는데,

그래서 이걸 적용을 해서 과제를 해보면 아주 Best of Best 일것 같아서 이렇게 과제를 해보려 한다.

물론 TableView, CollectionView 도 DataSource가 ...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/10%EC%A3%BC%EC%B0%A8-%EA%B3%BC%EC%A0%9C-(2)/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1714852800"
  data-df="YYYY/MM/DD"
  
>
  2024/05/05
</time>

              <h4 class="pt-0 my-2">10주차 과제 (2)</h4>
              <div class="text-muted">
                <p>
                  





                  

SearchBar Publisher 생성

CollectionView, TableView의 Delegata, DataSource를 어떻게 해야할지 고민 하기전에,

우선 SearchBar에 대한 부분은 먼저 끝내는게 좋다고 판단했다.

Publisher를 하나 만들어준다.

사이트를 참고하여 searchBar에 publisher를 연결하여 구현해본...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/10%EC%A3%BC%EC%B0%A8-%EA%B3%BC%EC%A0%9C-(3)/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1714852800"
  data-df="YYYY/MM/DD"
  
>
  2024/05/05
</time>

              <h4 class="pt-0 my-2">10주차 과제 (3)</h4>
              <div class="text-muted">
                <p>
                  





                  이제 진짜 문제의 시작.

문득 씻다가 이런생각이 들었다.

VM에 대해서 생각을 좀 해보았는데,

우리가 VC에 TableView관련 함수를 쓸 수 밖에 없었던 가장 큰 이유는, VC에 tableview가 있었고, 그걸 TableView 관련 protocol들을 가져왔어야 했기 때문이었다.

그러다보니 자연스럽게 VC가 처리할 내용이 많아졌다.

M...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/10%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1-%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6-(9)/"
      class="btn btn-outline-primary"
      aria-label="이전 글"
    >
      <p>10주차 과제 (9)</p>
    </a>
  

  
    <a
      href="/posts/10%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1-%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6-(11)/"
      class="btn btn-outline-primary"
      aria-label="다음 글"
    >
      <p>10주차 과제 (11)</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2024</time>

    
      <a href="https://github.com/haroldfromk">Dongik Song</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다."
      >일부 권리 보유</span>
    
  </p>

  <p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">인기 태그</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%BD%94%EB%94%A9%ED%85%8C%EC%8A%A4%ED%8A%B8/">코딩테스트</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EB%B3%B4%EB%A5%98%EC%A4%91/">보류중</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/swiftui/">SwiftUI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/myself/">Myself</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EB%B3%B4%EB%A5%98%ED%96%88%EB%8D%98%EB%AC%B8%EC%A0%9C/">보류했던문제</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EA%B3%BC%EC%A0%9C/">과제</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/networking/">Networking</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%95%BC%EA%B5%AC/">야구</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/git/">Git</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      업데이트
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/ko.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  





    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

