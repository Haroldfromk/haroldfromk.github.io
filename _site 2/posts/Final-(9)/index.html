<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="ko-KR" >
  <head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4791588234419923"
     crossorigin="anonymous"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Final (9)" />
<meta property="og:locale" content="ko_KR" />
<meta name="description" content="내가쓴 리뷰를 확인 할 수 있는 기능 구현" />
<meta property="og:description" content="내가쓴 리뷰를 확인 할 수 있는 기능 구현" />
<link rel="canonical" href="http://localhost:4000/posts/Final-(9)/" />
<meta property="og:url" content="http://localhost:4000/posts/Final-(9)/" />
<meta property="og:site_name" content="Harold`s DLog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-06-08T01:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Final (9)" />
<meta name="twitter:site" content="@twitter_username" />
<meta name="google-site-verification" content="AW90BDnepHsDdmQ6OaGtfM4bGYM_XM-4atRcFmERHVY" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-06-08T01:00:00+09:00","datePublished":"2024-06-08T01:00:00+09:00","description":"내가쓴 리뷰를 확인 할 수 있는 기능 구현","headline":"Final (9)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/Final-(9)/"},"url":"http://localhost:4000/posts/Final-(9)/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Final (9) | Harold`s DLog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Harold`s DLog">
<meta name="application-name" content="Harold`s DLog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    
      <link rel="preconnect" href="https://polyfill.io" >
      <link rel="dns-prefetch" href="https://polyfill.io" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }
          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();
      });
    } /* constructor() */

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isSysDarkPrefer() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get isLightMode() {
      return this.mode === ModeToggle.LIGHT_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }
        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }
      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    } /* flipMode() */
  } /* ModeToggle */

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->
<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
  <!-- .sidebar-badge -->
    <a href="/" id="avatar" class="rounded-circle"><img src="https://i.ibb.co/SQtS8n8/avatar.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <h1 class="site-title">
      <a href="/">Harold`s DLog</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">토프레와 애플을 좋아하는 사람의 Daily, Dev Log</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>홈</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>카테고리</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>태그</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>아카이브</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>정보</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>
  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/haroldfromk"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['dongik369','naver.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">홈</a>
            </span>

          
        
          
        
          
            
              <span>Final (9)</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      포스트
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="검색..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">취소</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Final (9)</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        게시
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1717776000"
  data-df="YYYY/MM/DD"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  2024/06/08
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/haroldfromk">Dongik Song</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2350 단어"
>
  <em>13 분</em>읽는 시간</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    <h2 id="내가쓴-리뷰를-확인-할-수-있는-기능-구현"><span class="me-2">내가쓴 리뷰를 확인 할 수 있는 기능 구현</span><a href="#내가쓴-리뷰를-확인-할-수-있는-기능-구현" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>이건 그냥 uid에 해당하는 documents만 가져오면 된다.</p>

<p>UserReview의 컬렉션에서 field가 uid에서 유져의 값과 일치하는 녀석만 가져오게 하면된다.</p>

<h3 id="1-usermanager-작성"><span class="me-2">1. userManager 작성</span><a href="#1-usermanager-작성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">getMyReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kd">@escaping</span><span class="p">(</span><span class="kt">QuerySnapshot</span><span class="p">?,</span> <span class="p">(</span><span class="kt">Error</span><span class="p">)?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">reviewCollection</span><span class="o">.</span><span class="nf">whereField</span><span class="p">(</span><span class="s">"uid"</span><span class="p">,</span> <span class="nv">isEqualTo</span><span class="p">:</span> <span class="n">uid</span><span class="p">)</span><span class="o">.</span><span class="nf">order</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="s">"createdAt"</span><span class="p">)</span><span class="o">.</span><span class="nf">getDocuments</span><span class="p">(</span><span class="nv">completion</span><span class="p">:</span> <span class="n">completion</span><span class="p">)</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>함수는 다음과 같이 구현.</p>

<h3 id="2-vm-작성"><span class="me-2">2. VM 작성</span><a href="#2-vm-작성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">getUserReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">userManager</span><span class="o">.</span><span class="nf">getMyReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="n">uid</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">querySnapshot</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="p">{</span>
                <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">reviewPublisher</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="nv">completion</span><span class="p">:</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
            <span class="p">}</span>
            
            <span class="k">if</span> <span class="k">let</span> <span class="nv">snapshotDocuments</span> <span class="o">=</span> <span class="n">querySnapshot</span><span class="p">?</span><span class="o">.</span><span class="n">documents</span> <span class="p">{</span>
                <span class="k">if</span> <span class="o">!</span><span class="n">snapshotDocuments</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
                    <span class="k">for</span> <span class="n">doc</span> <span class="k">in</span> <span class="n">snapshotDocuments</span> <span class="p">{</span>
                        <span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="nf">data</span><span class="p">()</span>
                        <span class="k">guard</span>
                            <span class="k">let</span> <span class="nv">uid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"uid"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">title</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"title"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">storeAddress</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"storeAddress"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">content</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"content"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">rating</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"rating"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Float</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">imageURL</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"imageURL"</span><span class="p">]</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">String</span><span class="p">],</span>
                            <span class="k">let</span> <span class="nv">isActivate</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"isActivate"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Bool</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">createdAt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"createdAt"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Timestamp</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">updatedAt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"updatedAt"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Timestamp</span>
                        <span class="k">else</span> <span class="p">{</span>
                            <span class="k">return</span>
                        <span class="p">}</span>
                        <span class="k">let</span> <span class="nv">reviewData</span> <span class="o">=</span> <span class="kt">ReviewModel</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="n">uid</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="nv">storeAddress</span><span class="p">:</span> <span class="n">storeAddress</span><span class="p">,</span> <span class="nv">content</span><span class="p">:</span> <span class="n">content</span><span class="p">,</span> <span class="nv">rating</span><span class="p">:</span> <span class="n">rating</span><span class="p">,</span> <span class="nv">imageURL</span><span class="p">:</span> <span class="n">imageURL</span><span class="p">,</span> <span class="nv">isActivate</span><span class="p">:</span> <span class="n">isActivate</span><span class="p">,</span> <span class="nv">createdAt</span><span class="p">:</span> <span class="n">createdAt</span><span class="p">,</span> <span class="nv">updatedAt</span><span class="p">:</span> <span class="n">updatedAt</span><span class="p">)</span>
                        <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">userReview</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">reviewData</span><span class="p">)</span>
                        <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">reviewPublisher</span><span class="o">.</span><span class="nf">send</span><span class="p">(())</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="3-vc-작성"><span class="me-2">3. VC 작성</span><a href="#3-vc-작성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="kd">private</span> <span class="kd">func</span> <span class="nf">getData</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">viewModel</span><span class="o">.</span><span class="nf">getUserReview</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">bind</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">viewModel</span><span class="o">.</span><span class="n">$userReview</span>
            <span class="o">.</span><span class="nf">print</span><span class="p">()</span>
            <span class="o">.</span><span class="n">sink</span> <span class="p">{</span> <span class="n">_</span> <span class="k">in</span>
            <span class="k">self</span><span class="o">.</span><span class="n">collectionView</span><span class="o">.</span><span class="nf">reloadData</span><span class="p">()</span>
        <span class="p">}</span><span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">cancellables</span><span class="p">)</span>
        
        <span class="n">viewModel</span><span class="o">.</span><span class="n">reviewPublisher</span><span class="o">.</span><span class="n">sink</span> <span class="p">{</span> <span class="n">completion</span> <span class="k">in</span>
            <span class="k">switch</span> <span class="n">completion</span> <span class="p">{</span>
            <span class="k">case</span> <span class="o">.</span><span class="nv">finished</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="nv">receiveValue</span><span class="p">:</span> <span class="p">{</span> <span class="n">_</span> <span class="k">in</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"received"</span><span class="p">)</span>
        <span class="p">}</span><span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">cancellables</span><span class="p">)</span>

    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>하지만 에러가 발생</p>

<p>뭐가 문제일까 해서 보니 updatedAt을 이전에 사용하지 않아서 생긴 문제</p>

<p>즉 guard문에서 return되면서 종료되었던것</p>

<p>그래서 필드를 추가해주고 글을 작성할때도 updatedAt을 넣게 해주었다.</p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/c9a7e783-ac65-491e-ab2a-3d9f595f37c2" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/c9a7e783-ac65-491e-ab2a-3d9f595f37c2" alt="image" loading="lazy"></a></p>

<p>성공.</p>

<h2 id="리뷰-수정-페이지-구현"><span class="me-2">리뷰 수정 페이지 구현.</span><a href="#리뷰-수정-페이지-구현" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>작성과 수정을 같이 하기위해서, 굳이 또 VC를 만들어야하나에 대한 의구심이 생겼다.</p>

<p><code class="language-plaintext highlighter-rouge">var isEditMode: Bool = false</code> 이녀석을 만들어서</p>

<p>새로작성할때는 false 유지,</p>

<p>수정할때만 true로 값을 넘겨서 하려고한다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">submitButtonTapped</span><span class="p">()</span> <span class="p">{</span>
        
        <span class="k">if</span> <span class="n">isEditMode</span> <span class="o">==</span> <span class="kc">false</span> <span class="p">{</span>
            <span class="nf">writeReview</span><span class="p">()</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">editReview</span><span class="p">()</span>
        <span class="p">}</span>
        
       
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="1-데이터를-전달하기-위한-코드-수정"><span class="me-2">1. 데이터를 전달하기 위한 코드 수정</span><a href="#1-데이터를-전달하기-위한-코드-수정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>아무래도 indexPath가 필요하여 프로토콜부분과 관련된 모든 부분이 고쳐져야할 필요성을 느꼈다.</p>

<p>우선 프로토콜에 indexpath를 추가한다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kd">protocol</span> <span class="kt">ReviewCellDelegate</span><span class="p">:</span> <span class="kt">AnyObject</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">editReview</span><span class="p">(</span><span class="n">_</span> <span class="nv">review</span><span class="p">:</span> <span class="kt">ReviewModel</span><span class="p">,</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span>
    <span class="kd">func</span> <span class="nf">deleteReview</span><span class="p">(</span><span class="n">_</span> <span class="nv">review</span><span class="p">:</span> <span class="kt">ReviewModel</span><span class="p">,</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>관련 함수 수정</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="kd">extension</span> <span class="kt">MyReviewViewController</span><span class="p">:</span> <span class="kt">ReviewCellDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">editReview</span><span class="p">(</span><span class="n">_</span> <span class="nv">review</span><span class="p">:</span> <span class="kt">ReviewModel</span><span class="p">,</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">writeVC</span> <span class="o">=</span> <span class="kt">WriteViewController</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">item</span> <span class="o">=</span> <span class="n">viewModel</span><span class="o">.</span><span class="n">userReview</span><span class="p">[</span><span class="n">indexPath</span><span class="o">.</span><span class="n">row</span><span class="p">]</span>
        <span class="n">writeVC</span><span class="o">.</span><span class="n">isEditMode</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">writeVC</span><span class="o">.</span><span class="n">isNavagtion</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">writeVC</span><span class="o">.</span><span class="n">review</span> <span class="o">=</span> <span class="n">item</span>
        
        <span class="n">navigationController</span><span class="p">?</span><span class="o">.</span><span class="nf">pushViewController</span><span class="p">(</span><span class="n">writeVC</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">deleteReview</span><span class="p">(</span><span class="n">_</span> <span class="nv">review</span><span class="p">:</span> <span class="kt">ReviewModel</span><span class="p">,</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">item</span> <span class="o">=</span> <span class="n">viewModel</span><span class="o">.</span><span class="n">userReview</span><span class="p">[</span><span class="n">indexPath</span><span class="o">.</span><span class="n">row</span><span class="p">]</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>데이터를 ui로 전달하는 함수도 만들고, Kingfisher를 사용하여 이미지를 가져오는것도 했다.</p>

<p>Kingfisher가 이미지를 uiimage로 바꿀수 있는건 첨알았다.</p>

<p>보통은 이미지 뷰에서 url을 가져와서 바로 적용을 했지 해당 메서드 사용은 처음이다.</p>

<p><a href="https://terry-some.tistory.com/m/89">출처</a></p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="kd">private</span> <span class="kd">func</span> <span class="nf">setDataForEdit</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">review</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="n">titleTextField</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">review</span><span class="p">?</span><span class="o">.</span><span class="n">title</span>
            <span class="n">contentTextView</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">review</span><span class="p">?</span><span class="o">.</span><span class="n">content</span>
            <span class="n">selectedRating</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="n">review</span><span class="o">!.</span><span class="n">rating</span><span class="p">)</span>
            <span class="nf">updateStarButtons</span><span class="p">()</span>
            <span class="nf">getImages</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
<span class="kd">private</span> <span class="kd">func</span> <span class="nf">getImages</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">review</span><span class="p">?</span><span class="o">.</span><span class="n">imageURL</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="n">url</span> <span class="k">in</span>
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">imageURL</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
            <span class="kt">KingfisherManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">retrieveImage</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">imageURL</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
                <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
                <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">image</span><span class="p">):</span>
                    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                        <span class="k">self</span><span class="o">.</span><span class="nf">addImageToStackView</span><span class="p">(</span><span class="nv">image</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
                        <span class="k">self</span><span class="o">.</span><span class="n">selectedImages</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
                    <span class="nf">print</span><span class="p">(</span><span class="s">"Error: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/9ad888d2-38a8-4a74-87b9-4bca4e01ba5b" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/9ad888d2-38a8-4a74-87b9-4bca4e01ba5b" alt="Jun-08-2024 23-59-39" width="50%" height="50%" loading="lazy"></a></p>

<p>완료.</p>

<h2 id="document-수정-기능-구현"><span class="me-2">Document 수정 기능 구현</span><a href="#document-수정-기능-구현" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>이제 메인기능이 남았다.</p>

<p>UserManager에는 다음과 같이 구현했다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">editReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">storeAddress</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kd">@escaping</span><span class="p">(</span><span class="kt">QuerySnapshot</span><span class="p">?,</span> <span class="p">(</span><span class="kt">Error</span><span class="p">)?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">reviewCollection</span><span class="o">.</span><span class="nf">whereField</span><span class="p">(</span><span class="s">"uid"</span><span class="p">,</span> <span class="nv">isEqualTo</span><span class="p">:</span> <span class="n">uid</span><span class="p">)</span><span class="o">.</span><span class="nf">whereField</span><span class="p">(</span><span class="s">"storeAddress"</span><span class="p">,</span> <span class="nv">arrayContains</span><span class="p">:</span> <span class="n">storeAddress</span><span class="p">)</span><span class="o">.</span><span class="nf">whereField</span><span class="p">(</span><span class="s">"title"</span><span class="p">,</span> <span class="nv">arrayContains</span><span class="p">:</span> <span class="n">title</span><span class="p">)</span><span class="o">.</span><span class="nf">getDocuments</span><span class="p">(</span><span class="nv">completion</span><span class="p">:</span> <span class="n">completion</span><span class="p">)</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>유져의 uid, 가게주소, 작성한 제목을 바탕으로 수정하는 작업을 하게 된다.</p>

<p>우선 VM은 다음과 같이 했다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">editUserReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">storeAddress</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">userDict</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">Any</span><span class="p">])</span> <span class="p">{</span>
        <span class="n">userManager</span><span class="o">.</span><span class="nf">editReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="n">uid</span><span class="p">,</span> <span class="nv">storeAddress</span><span class="p">:</span> <span class="n">storeAddress</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="n">title</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span> <span class="p">]</span> <span class="n">querySnapshot</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="p">{</span>
                <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">reviewPublisher</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="nv">completion</span><span class="p">:</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
            <span class="p">}</span>
            
            <span class="k">if</span> <span class="k">let</span> <span class="nv">documents</span> <span class="o">=</span> <span class="n">querySnapshot</span><span class="p">?</span><span class="o">.</span><span class="n">documents</span> <span class="p">{</span>
                <span class="k">for</span> <span class="n">doc</span> <span class="k">in</span> <span class="n">documents</span> <span class="p">{</span>
                    <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">documentID</span>
                    <span class="n">reviewCollection</span><span class="o">.</span><span class="nf">document</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="nf">setData</span><span class="p">(</span><span class="n">userDict</span><span class="p">,</span> <span class="nv">merge</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>VC 수정</p>

<p>isEditMode를 기준으로 삼항연산자를 사용하여 다음과 같이 구현</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre></td><td class="rouge-code"><pre><span class="kd">private</span> <span class="kd">func</span> <span class="nf">reviewTapped</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">guard</span>
            <span class="k">let</span> <span class="nv">uid</span> <span class="o">=</span> <span class="kt">Auth</span><span class="o">.</span><span class="nf">auth</span><span class="p">()</span><span class="o">.</span><span class="n">currentUser</span><span class="p">?</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span>
            <span class="k">let</span> <span class="nv">title</span> <span class="o">=</span> <span class="n">titleTextField</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
            <span class="k">let</span> <span class="nv">content</span> <span class="o">=</span> <span class="n">contentTextView</span><span class="o">.</span><span class="n">text</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>
        
        <span class="nf">uploadImages</span><span class="p">(</span><span class="nv">images</span><span class="p">:</span> <span class="n">selectedImages</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">sink</span><span class="p">(</span><span class="nv">receiveCompletion</span><span class="p">:</span> <span class="p">{</span> <span class="n">completion</span> <span class="k">in</span>
                <span class="k">switch</span> <span class="n">completion</span> <span class="p">{</span>
                <span class="k">case</span> <span class="o">.</span><span class="nv">finished</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
                    <span class="k">let</span> <span class="nv">alert</span> <span class="o">=</span> <span class="kt">UIAlertController</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"에러 발생"</span><span class="p">,</span> <span class="nv">message</span><span class="p">:</span> <span class="s">"</span><span class="se">\(</span><span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="se">)</span><span class="s">이 발생했습니다."</span><span class="p">,</span> <span class="nv">preferredStyle</span><span class="p">:</span> <span class="o">.</span><span class="n">alert</span><span class="p">)</span>
                    <span class="n">alert</span><span class="o">.</span><span class="nf">addAction</span><span class="p">(</span><span class="kt">UIAlertAction</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"확인"</span><span class="p">,</span> <span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="k">default</span><span class="p">))</span>
                    <span class="k">self</span><span class="o">.</span><span class="nf">present</span><span class="p">(</span><span class="n">alert</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">},</span> <span class="nv">receiveValue</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">imageURLs</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
                
                <span class="k">let</span> <span class="nv">dictionary</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s">"uid"</span><span class="p">:</span> <span class="n">uid</span><span class="p">,</span>
                    <span class="s">"title"</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
                    <span class="s">"storeAddress"</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">addressText</span><span class="o">!</span><span class="p">,</span>
                    <span class="s">"storeName"</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">storeTitleText</span><span class="o">!</span><span class="p">,</span>
                    <span class="s">"content"</span><span class="p">:</span> <span class="n">content</span><span class="p">,</span>
                    <span class="s">"rating"</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">selectedRating</span><span class="p">,</span>
                    <span class="s">"imageURL"</span><span class="p">:</span> <span class="n">imageURLs</span><span class="p">,</span>
                    <span class="s">"isActive"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
                    <span class="s">"createdAt"</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">isEditMode</span> <span class="p">?</span> <span class="k">self</span><span class="o">.</span><span class="n">review</span><span class="o">!.</span><span class="nv">createdAt</span> <span class="p">:</span> <span class="kt">Timestamp</span><span class="p">(</span><span class="nv">date</span><span class="p">:</span> <span class="kt">Date</span><span class="p">()),</span>
                    <span class="s">"updatedAt"</span><span class="p">:</span> <span class="kt">Timestamp</span><span class="p">(</span><span class="nv">date</span><span class="p">:</span> <span class="kt">Date</span><span class="p">())</span>
                <span class="p">]</span>
                
                <span class="k">if</span> <span class="k">self</span><span class="o">.</span><span class="n">isEditMode</span> <span class="p">{</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">viewModel</span><span class="o">.</span><span class="nf">editUserReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="n">uid</span><span class="p">,</span> <span class="nv">storeAddress</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">addressText</span><span class="o">!</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">storeTitleText</span><span class="o">!</span><span class="p">,</span> <span class="nv">userDict</span><span class="p">:</span> <span class="n">dictionary</span><span class="p">)</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">viewModel</span><span class="o">.</span><span class="nf">createReview</span><span class="p">(</span><span class="nv">userDict</span><span class="p">:</span> <span class="n">dictionary</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">})</span>
            <span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">cancellables</span><span class="p">)</span>
        
        <span class="k">let</span> <span class="nv">alertTitle</span> <span class="o">=</span> <span class="n">isEditMode</span> <span class="p">?</span> <span class="s">"리뷰 수정"</span> <span class="p">:</span> <span class="s">"리뷰 저장"</span>
        <span class="k">let</span> <span class="nv">alertMessage</span> <span class="o">=</span> <span class="n">isEditMode</span> <span class="p">?</span> <span class="s">"리뷰가 수정 되었습니다."</span> <span class="p">:</span> <span class="s">"리뷰가 등록 되었습니다."</span>
        <span class="k">let</span> <span class="nv">alert</span> <span class="o">=</span> <span class="kt">UIAlertController</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="n">alertTitle</span><span class="p">,</span> <span class="nv">message</span><span class="p">:</span> <span class="n">alertMessage</span><span class="p">,</span> <span class="nv">preferredStyle</span><span class="p">:</span> <span class="o">.</span><span class="n">alert</span><span class="p">)</span>
        <span class="n">alert</span><span class="o">.</span><span class="nf">addAction</span><span class="p">(</span><span class="kt">UIAlertAction</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"확인"</span><span class="p">,</span> <span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="k">default</span><span class="p">,</span> <span class="nv">handler</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="k">self</span><span class="p">]</span> <span class="n">_</span> <span class="k">in</span>
            <span class="k">if</span> <span class="k">self</span><span class="o">.</span><span class="n">isNavagtion</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">navigationController</span><span class="p">?</span><span class="o">.</span><span class="nf">popViewController</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="nf">dismiss</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}))</span>
        <span class="nf">present</span><span class="p">(</span><span class="n">alert</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>문제점 확인.</p>

<p>옵셔널 문제가 발생해서 생각해보니, addressText, storeTitleText를 넘기지 않은게 원인이다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kd">private</span> <span class="kd">func</span> <span class="nf">setDataForEdit</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">review</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="n">titleTextField</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">review</span><span class="p">?</span><span class="o">.</span><span class="n">title</span>
            <span class="n">contentTextView</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">review</span><span class="p">?</span><span class="o">.</span><span class="n">content</span>
            <span class="n">selectedRating</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="n">review</span><span class="o">!.</span><span class="n">rating</span><span class="p">)</span>
            <span class="n">addressText</span> <span class="o">=</span> <span class="n">review</span><span class="p">?</span><span class="o">.</span><span class="n">storeAddress</span>
            <span class="n">storeTitleText</span> <span class="o">=</span> <span class="n">review</span><span class="p">?</span><span class="o">.</span><span class="n">storeName</span>
            <span class="nf">updateStarButtons</span><span class="p">()</span>
            <span class="nf">getImages</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>하지만 에러가 발생</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>Error Domain=FIRFirestoreErrorDomain Code=3 "A maximum of 1 'ARRAY_CONTAINS' filter is allowed per disjunction." UserInfo={NSLocalizedDescription=A maximum of 1 'ARRAY_CONTAINS' filter is allowed per disjunction.}
</pre></td></tr></tbody></table></code></div></div>

<p>어디가 문제있나 봤더니 자동완성으로 생긴 문제로 보인다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">editReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">storeAddress</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kd">@escaping</span><span class="p">(</span><span class="kt">QuerySnapshot</span><span class="p">?,</span> <span class="p">(</span><span class="kt">Error</span><span class="p">)?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">reviewCollection</span><span class="o">.</span><span class="nf">whereField</span><span class="p">(</span><span class="s">"uid"</span><span class="p">,</span> <span class="nv">isEqualTo</span><span class="p">:</span> <span class="n">uid</span><span class="p">)</span><span class="o">.</span><span class="nf">whereField</span><span class="p">(</span><span class="s">"storeAddress"</span><span class="p">,</span> <span class="nv">isEqualTo</span><span class="p">:</span> <span class="n">storeAddress</span><span class="p">)</span><span class="o">.</span><span class="nf">whereField</span><span class="p">(</span><span class="s">"title"</span><span class="p">,</span> <span class="nv">isEqualTo</span><span class="p">:</span> <span class="n">title</span><span class="p">)</span><span class="o">.</span><span class="nf">getDocuments</span><span class="p">(</span><span class="nv">completion</span><span class="p">:</span> <span class="n">completion</span><span class="p">)</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">isEqualTo</code>가 <code class="language-plaintext highlighter-rouge">arrayContains</code>이걸로 되어있었다.</p>

<p>수정이 되지않아 뭐가 문제일까 봤더니</p>

<p><code class="language-plaintext highlighter-rouge">self.viewModel.editUserReview(uid: uid, storeAddress: self.addressText!, title: title, userDict: dictionary)</code></p>

<p>여기 title이 가게명으로 되어있었다.</p>

<p>또한 documents를 못찾는 문제가 발생했다.</p>

<p>생각해보니 title을 바꾸면서 쿼리를 못찾는것같다.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">viewModel</span><span class="o">.</span><span class="nf">editUserReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="n">uid</span><span class="p">,</span> <span class="nv">storeAddress</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">addressText</span><span class="o">!</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="n">review</span><span class="o">!.</span><span class="n">title</span><span class="p">,</span> <span class="nv">userDict</span><span class="p">:</span> <span class="n">dictionary</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>title을 변경된 값이 아닌 기존에 들고온 리뷰 제목을 해야 그에 맞는게 수정이 된다.</p>

<p>너무 안일하게 생각해서 생긴 문제.</p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/9b23a35d-f52e-44bc-8464-8c79c3dd3e1f" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/9b23a35d-f52e-44bc-8464-8c79c3dd3e1f" alt="simulator_screenshot_E0BB79FB-61EA-4C61-A7B4-4FA2BB7001A5" width="50%" height="50%" loading="lazy"></a></p>

<p>수정은 되었으나 너무 빨리 dismiss가 되어 서버에 변경되기전 VC가 이미 호출되어 리뷰가 이전께 보여지는 문제가 발생.</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="kt">ProgressHUD</span><span class="o">.</span><span class="nf">animate</span><span class="p">()</span>
        <span class="k">let</span> <span class="nv">alertTitle</span> <span class="o">=</span> <span class="n">isEditMode</span> <span class="p">?</span> <span class="s">"리뷰 수정"</span> <span class="p">:</span> <span class="s">"리뷰 저장"</span>
        <span class="k">let</span> <span class="nv">alertMessage</span> <span class="o">=</span> <span class="n">isEditMode</span> <span class="p">?</span> <span class="s">"리뷰가 수정 되었습니다."</span> <span class="p">:</span> <span class="s">"리뷰가 등록 되었습니다."</span>
        <span class="k">let</span> <span class="nv">alert</span> <span class="o">=</span> <span class="kt">UIAlertController</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="n">alertTitle</span><span class="p">,</span> <span class="nv">message</span><span class="p">:</span> <span class="n">alertMessage</span><span class="p">,</span> <span class="nv">preferredStyle</span><span class="p">:</span> <span class="o">.</span><span class="n">alert</span><span class="p">)</span>
        <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">asyncAfter</span><span class="p">(</span><span class="nv">deadline</span><span class="p">:</span> <span class="o">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="k">self</span><span class="p">]</span> <span class="k">in</span>
            <span class="n">alert</span><span class="o">.</span><span class="nf">addAction</span><span class="p">(</span><span class="kt">UIAlertAction</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"확인"</span><span class="p">,</span> <span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="k">default</span><span class="p">,</span> <span class="nv">handler</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="k">self</span><span class="p">]</span> <span class="n">_</span> <span class="k">in</span>
                <span class="k">if</span> <span class="n">isNavagtion</span> <span class="p">{</span>
                    <span class="n">navigationController</span><span class="p">?</span><span class="o">.</span><span class="nf">popViewController</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nf">dismiss</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}))</span>
            <span class="kt">ProgressHUD</span><span class="o">.</span><span class="nf">remove</span><span class="p">()</span>
            <span class="nf">present</span><span class="p">(</span><span class="n">alert</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
        <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>임시방편으로 약간의 로딩시간을 주었다.</p>

<p>그리고 vc재 호출시 수정이 안되는거같아서 확인했보니 append로 계속 누적이 되는걸 확인</p>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">getUserReview</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">uid</span> <span class="o">=</span> <span class="kt">Auth</span><span class="o">.</span><span class="nf">auth</span><span class="p">()</span><span class="o">.</span><span class="n">currentUser</span><span class="p">?</span><span class="o">.</span><span class="n">uid</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        
        <span class="n">userManager</span><span class="o">.</span><span class="nf">getMyReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="n">uid</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">querySnapshot</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
            <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">userReview</span><span class="o">.</span><span class="nf">removeAll</span><span class="p">()</span> <span class="c1">// added</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="p">{</span>
                <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">reviewPublisher</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="nv">completion</span><span class="p">:</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
            <span class="p">}</span>
            
            <span class="k">if</span> <span class="k">let</span> <span class="nv">snapshotDocuments</span> <span class="o">=</span> <span class="n">querySnapshot</span><span class="p">?</span><span class="o">.</span><span class="n">documents</span> <span class="p">{</span>
                <span class="k">if</span> <span class="o">!</span><span class="n">snapshotDocuments</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
                    <span class="k">for</span> <span class="n">doc</span> <span class="k">in</span> <span class="n">snapshotDocuments</span> <span class="p">{</span>
                        <span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="nf">data</span><span class="p">()</span>
                        <span class="k">guard</span>
                            <span class="k">let</span> <span class="nv">uid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"uid"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">title</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"title"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">storeName</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"storeName"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">storeAddress</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"storeAddress"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">content</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"content"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">rating</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"rating"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Float</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">imageURL</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"imageURL"</span><span class="p">]</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">String</span><span class="p">],</span>
                            <span class="k">let</span> <span class="nv">isActive</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"isActive"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Bool</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">createdAt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"createdAt"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Timestamp</span><span class="p">,</span>
                            <span class="k">let</span> <span class="nv">updatedAt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"updatedAt"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">Timestamp</span>
                        <span class="k">else</span> <span class="p">{</span>
                            <span class="nf">print</span><span class="p">(</span><span class="s">"error"</span><span class="p">)</span>
                            <span class="k">return</span>
                        <span class="p">}</span>
                        <span class="k">let</span> <span class="nv">reviewData</span> <span class="o">=</span> <span class="kt">ReviewModel</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="n">uid</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="nv">storeAddress</span><span class="p">:</span> <span class="n">storeAddress</span><span class="p">,</span> <span class="nv">storeName</span><span class="p">:</span> <span class="n">storeName</span><span class="p">,</span> <span class="nv">content</span><span class="p">:</span> <span class="n">content</span><span class="p">,</span> <span class="nv">rating</span><span class="p">:</span> <span class="n">rating</span><span class="p">,</span> <span class="nv">imageURL</span><span class="p">:</span> <span class="n">imageURL</span><span class="p">,</span> <span class="nv">isActive</span><span class="p">:</span> <span class="n">isActive</span><span class="p">,</span> <span class="nv">createdAt</span><span class="p">:</span> <span class="n">createdAt</span><span class="p">,</span> <span class="nv">updatedAt</span><span class="p">:</span> <span class="n">updatedAt</span><span class="p">)</span>
                        <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">userReview</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">reviewData</span><span class="p">)</span>
                        <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">reviewPublisher</span><span class="o">.</span><span class="nf">send</span><span class="p">(())</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>이렇게 로드하기전 배열을 비우기로했다.</p>

<p><a href="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/ad642fd7-b42c-4081-ba9e-e7897e2b6465" class="popup img-link  shimmer"><img src="https://github.com/Haroldfromk/haroldfromk.github.io/assets/97341336/ad642fd7-b42c-4081-ba9e-e7897e2b6465" alt="Jun-09-2024 02-22-58" width="50%" height="50%" loading="lazy"></a></p>

<h2 id="document-삭제-기능-구현"><span class="me-2">Document 삭제 기능 구현</span><a href="#document-삭제-기능-구현" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>이건 크게 어려운 문제가 아니다.</p>

<h3 id="1-usermanager작성"><span class="me-2">1. UserManager작성</span><a href="#1-usermanager작성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">getSpecificReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">storeAddress</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kd">@escaping</span><span class="p">(</span><span class="kt">QuerySnapshot</span><span class="p">?,</span> <span class="p">(</span><span class="kt">Error</span><span class="p">)?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">reviewCollection</span><span class="o">.</span><span class="nf">whereField</span><span class="p">(</span><span class="s">"uid"</span><span class="p">,</span> <span class="nv">isEqualTo</span><span class="p">:</span> <span class="n">uid</span><span class="p">)</span><span class="o">.</span><span class="nf">whereField</span><span class="p">(</span><span class="s">"storeAddress"</span><span class="p">,</span> <span class="nv">isEqualTo</span><span class="p">:</span> <span class="n">storeAddress</span><span class="p">)</span><span class="o">.</span><span class="nf">whereField</span><span class="p">(</span><span class="s">"title"</span><span class="p">,</span> <span class="nv">isEqualTo</span><span class="p">:</span> <span class="n">title</span><span class="p">)</span><span class="o">.</span><span class="nf">getDocuments</span><span class="p">(</span><span class="nv">completion</span><span class="p">:</span> <span class="n">completion</span><span class="p">)</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>생각해보니 특정 필드에 대한 값을 가져와서 삭제하므로 이름을 변경해주었다.</p>

<h3 id="2-vm-작성-1"><span class="me-2">2. VM 작성</span><a href="#2-vm-작성-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">removeUserReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">storeAddress</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">userManager</span><span class="o">.</span><span class="nf">getSpecificReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="n">uid</span><span class="p">,</span> <span class="nv">storeAddress</span><span class="p">:</span> <span class="n">storeAddress</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="n">title</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span> <span class="p">]</span> <span class="n">querySnapshot</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="p">{</span>
                <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">reviewPublisher</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="nv">completion</span><span class="p">:</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
            <span class="p">}</span>
            
            <span class="k">if</span> <span class="k">let</span> <span class="nv">documents</span> <span class="o">=</span> <span class="n">querySnapshot</span><span class="p">?</span><span class="o">.</span><span class="n">documents</span> <span class="p">{</span>
              
                <span class="k">for</span> <span class="n">doc</span> <span class="k">in</span> <span class="n">documents</span> <span class="p">{</span>
                    <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">documentID</span>
                    <span class="n">reviewCollection</span><span class="o">.</span><span class="nf">document</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="nf">delete</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>그냥 delete만 쳐주면 된다.</p>

<h3 id="3-vc-작성-1"><span class="me-2">3. VC 작성</span><a href="#3-vc-작성-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-swift highlighter-rouge"><div class="code-header">
        <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">deleteReview</span><span class="p">(</span><span class="n">_</span> <span class="nv">review</span><span class="p">:</span> <span class="kt">ReviewModel</span><span class="p">,</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">IndexPath</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">item</span> <span class="o">=</span> <span class="n">viewModel</span><span class="o">.</span><span class="n">userReview</span><span class="p">[</span><span class="n">indexPath</span><span class="o">.</span><span class="n">row</span><span class="p">]</span>
        <span class="k">let</span> <span class="nv">alert</span> <span class="o">=</span> <span class="kt">UIAlertController</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"삭제 확인"</span><span class="p">,</span> <span class="nv">message</span><span class="p">:</span> <span class="s">"삭제하시면 복원 할 수 없습니다."</span><span class="p">,</span> <span class="nv">preferredStyle</span><span class="p">:</span> <span class="o">.</span><span class="n">alert</span><span class="p">)</span>
        <span class="n">alert</span><span class="o">.</span><span class="nf">addAction</span><span class="p">(</span><span class="kt">UIAlertAction</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"확인"</span><span class="p">,</span> <span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="n">destructive</span><span class="p">,</span> <span class="nv">handler</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="k">self</span><span class="p">]</span> <span class="n">_</span> <span class="k">in</span>
            <span class="n">viewModel</span><span class="o">.</span><span class="nf">removeUserReview</span><span class="p">(</span><span class="nv">uid</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span> <span class="nv">storeAddress</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">storeAddress</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
            
            <span class="nf">getData</span><span class="p">()</span>
            <span class="nf">bind</span><span class="p">()</span>
        <span class="p">}))</span>
        <span class="n">alert</span><span class="o">.</span><span class="nf">addAction</span><span class="p">(</span><span class="kt">UIAlertAction</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"취소"</span><span class="p">,</span> <span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="k">default</span><span class="p">))</span>
        <span class="nf">present</span><span class="p">(</span><span class="n">alert</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>우선 삭제는 되나 collectionview에 바로 보이지는 않는다.</p>

<p>아무래도 DiffableDatasource를 사용해야할듯싶다.</p>

<p>그건 내일 하는걸로…</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/%EC%BA%A0%ED%94%84/">캠프</a>,
          <a href="/categories/thelast/">TheLast</a>
      </div>
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          이 기사는 저작권자의 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         라이센스를 따릅니다.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">공유하기</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Final%20(9)%20-%20Harold%60s%20DLog&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FFinal-%289%29%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Final%20(9)%20-%20Harold%60s%20DLog&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FFinal-%289%29%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FFinal-%289%29%2F&text=Final%20(9)%20-%20Harold%60s%20DLog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="링크 복사하기"
      data-title-succeed="링크가 복사되었습니다!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
<script src="https://utteranc.es/client.js"
  repo="haroldfromk/haroldfromk.github.io"
  issue-term="pathname"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script>

</article>



            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">최근 업데이트</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/ObjectTest/">CartAppTest</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/(Deep-Dive)-Object/">(Deep Dive) @ObservedObject vs @StateObject</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/TourApp_6/">TourApp (6)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/TourApp_5/">TourApp (5)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/TourApp_4/">TourApp (4)</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">인기 태그</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%BD%94%EB%94%A9%ED%85%8C%EC%8A%A4%ED%8A%B8/">코딩테스트</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EB%B3%B4%EB%A5%98%EC%A4%91/">보류중</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/swiftui/">SwiftUI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/myself/">Myself</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EB%B3%B4%EB%A5%98%ED%96%88%EB%8D%98%EB%AC%B8%EC%A0%9C/">보류했던문제</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EA%B3%BC%EC%A0%9C/">과제</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/networking/">Networking</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%95%BC%EA%B5%AC/">야구</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/git/">Git</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">바로가기</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">관련된 글</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/Final-(10)/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1717862400"
  data-df="YYYY/MM/DD"
  
>
  2024/06/09
</time>

              <h4 class="pt-0 my-2">Final (10)</h4>
              <div class="text-muted">
                <p>
                  





                  로그인 상태에따라 다른 페이지 보여주기.

SceneDelegate에서 함수를 하나 만들어서 실행하면 문제가 해결될걸로 보인다.

1
2
3
4
5
     if Auth.auth().currentUser != nil {
               window.rootViewController = tabbarController
           } ...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/Final-(11)/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1717948800"
  data-df="YYYY/MM/DD"
  
>
  2024/06/10
</time>

              <h4 class="pt-0 my-2">Final (11)</h4>
              <div class="text-muted">
                <p>
                  





                  Extension을 사용한 Alert 구현

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
extension UIViewController {
    
    func showMessage(title: String, message: String, completion: (() -&amp;gt; Void)? = ...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/Final-(12)/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1718035200"
  data-df="YYYY/MM/DD"
  
>
  2024/06/11
</time>

              <h4 class="pt-0 my-2">Final (12)</h4>
              <div class="text-muted">
                <p>
                  





                  이미지 업로드 TS

1. 문제점

현재 문제점은 이미지를 수정하게 되면 새롭게 이미지를 업로드 하는 방식으로 이루어 진다.

그러다보니 Storage에 불필요한 데이터가 계속 쌓이게 되고, 이는 서버 용량에도 부담이 된다.

그래서 이를 개선하기 위해 이미지를 수정하게 될 경우 파일 값을 일정하게하여 덮어씌우는 방식으로 하려고한다.

2. 이미지 업...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/Final-(8)/"
      class="btn btn-outline-primary"
      aria-label="이전 글"
    >
      <p>Final (8)</p>
    </a>
  

  
    <a
      href="/posts/Final-(10)/"
      class="btn btn-outline-primary"
      aria-label="다음 글"
    >
      <p>Final (10)</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2024</time>

    
      <a href="https://github.com/haroldfromk">Dongik Song</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다."
      >일부 권리 보유</span>
    
  </p>

  <p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">인기 태그</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%BD%94%EB%94%A9%ED%85%8C%EC%8A%A4%ED%8A%B8/">코딩테스트</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EB%B3%B4%EB%A5%98%EC%A4%91/">보류중</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/swiftui/">SwiftUI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/myself/">Myself</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EB%B3%B4%EB%A5%98%ED%96%88%EB%8D%98%EB%AC%B8%EC%A0%9C/">보류했던문제</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EA%B3%BC%EC%A0%9C/">과제</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/networking/">Networking</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%95%BC%EA%B5%AC/">야구</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/git/">Git</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      업데이트
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->




  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/ko.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.25.0/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  





    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

